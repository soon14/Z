<template>
	<div class='addCrm'>
	<!--固定导航-->
		<div class="head">
			<!-- <Col span='6'> -->
				<div class="left-top">
					<p class="wldw">
						<span style="width:42px;font-weight:900">{{$t('public.screen')}}：</span>
						 <Select style="width:100px" :placeholder="$t('public.all')" v-model='valueT'  @on-change="orderselected">
					        <Option v-for="item in orderListname" :value="item.value" :key="item.value">{{ item.label }}</Option>
					    </Select>
					</p>
					<div>
						<!--新建-->
						<span class="top-left-btn"  @click="add">
							<Icon type="plus" style="position:absolute;top:7px;left:8px"></Icon></span>
					</div>
				</div>
			
				<div class="right-top">
					<div style='position: absolute;left: 360px;'>
						<span style="margin-left:10px;font-size:14px;font-weight:900">{{crmDetail.name}}</span>
					</div>
					<div style='position: absolute;right: 150px;'>
						<div v-if="addText">
							<Button shape="circle"  style="background:#3b77e3;color:#fff;border:none" @click="saveCgInfo('formValidate')" >
							<Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>{{$t('public.SaveBtn')}}</Button><!--保存-->

							<Button shape="circle"  @click="addCancel"  style="background:#999999;color:#fff;margin-right:5px;" ><Icon type="close" style="margin-right:5px;"></Icon>{{$t('public.cancel')}}</Button><!--取消-->

							<span @click="cancelHome" style="cursor:pointer"><Icon type="close" class="cha" ></Icon></span>
						</div>

						<div v-if="!addText" class="changebutton">

							<Button type="ghost"  shape="circle"  @click="edit" v-if="editshow" style="background:#40ca98;color:#fff;border:none">
								<i class="el-icon-edit" style=";margin-right:5px;"></i>
							{{$t('public.EditBtn')}}<!--修改-->
							</Button>

							<Button type="ghost"  shape="circle" @click="saveEdit('formValidate1')" v-if="!editshow" style="background:#3b77e3;color:#fff;border:none">
								<Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>{{$t('public.SaveBtn')}}
							</Button>

							<Button shape="circle" v-if="!editshow"  @click="editCancel"  style="background:#999999;color:#fff;" ><Icon type="close" style="margin-right:5px;"></Icon>{{$t('public.cancel')}}</Button>

							<Dropdown trigger="click" >
								<Button shape="circle" type="ghost" style="background:#ff7d16;color:#fff;border:none">{{$t('public.more')}}
								<span><i class="ivu-icon ivu-icon-chevron-down"></i></span>
							</Button>

							<DropdownMenu slot="list">
								<span  @click="start" v-if="startisshow"><DropdownItem >恢复</DropdownItem></span>
								<span  @click="stop" v-if="startisstop"><DropdownItem >拉黑</DropdownItem></span>

								<span  @click="del"><DropdownItem >{{$t('public.del')}}</DropdownItem></span>
								<span  @click="passwordRest"><DropdownItem >{{$t('orders.Reset')}}</DropdownItem></span>
							</DropdownMenu>
						</Dropdown>
							<span @click="cancelHome" style="cursor:pointer;margin-left:5px" ><Icon type="close" class="cha" ></Icon>
							</span>
						</div>
					</div>
				</div>
			<!-- </Col> -->
		</div>
		<div style='height:60px'></div>
		<div style='display:flex;height:100%'>
		<!--左侧列表-->
			<div class="left-content">
				<div class='locationSearch'>
					<Input style='padding:10px 20px' v-model='searchKeyword' :placeholder="$t('public.codeornameorphone')" @on-enter='enterSearch'>
					<span slot="append"  @click='search' style='cursor:pointer;'>{{$t('public.search')}}</span>
					</Input>
					<!--  <a style='font-size:14px;font-weight:600;margin-left:20px;border-bottom:1px solid #3b77e3;height:35px;line-hegiht:35px;line-height: 35px;margin-top: -2px;' @click='searchLocation'>精准搜索</a> -->
				</div>
				<p v-if="Allcrm.length==0">
					<Spin fix>
						<!-- <Icon type="load-c" size=18 class="demo-spin-icon-load"></Icon> -->
						<div>{{$t('public.NoData')}}</div>
					</Spin>
				</p>
				<Scroll :on-reach-bottom="handleReachEdge" :height="height" v-else >
					<div class="con-list" v-for="(item,index) in Allcrm" :key='index' @click="getcginfo(item.id,index)" :class="{bg:numIndex==index}">
						<span class='left-img'>
							<img :src="item.photo" width='60' height='60'>
						</span>

						<div>
						<p class="list-title">{{item.code}}</p>
						<p class="txt" style="margin-top:20px;">
							{{item.name}}
							<span style='margin-left:4px'
					:class="{colorGender1:item.gender=='男',colorGender0:item.gender=='女'}">{{item.gender}}</span>
						</p>

						<span class="date">{{item.createTime}}</span>
						<div class="lanrenLeft" :class="{bg3:item.status==1,bg4:item.status==0}">
						<span >{{item.statusDesc}}</span>
						</div>​
						</div>
					</div>

				</Scroll>
			</div>
			<!--右侧-->
			<div class="add-right" >
				<div class='right-left' v-if='leftphoto'>
					<el-upload
						class="avatar-uploader"
						:action="logoUrl"
						name='file'
						:show-file-list="false"
						:before-upload="beforeAvatarUpload"
						:on-success="addsucess"
						accept="image/*"
						>
						<img v-if="photo" :src="photo" class="avatar" width='30' height='30'>
						<i v-else class="el-icon-plus avatar-uploader-icon"></i>
						</el-upload>

				</div>
				<!--新增-->
				<div class='right-right' v-if='addText'>
					<Form ref="formValidate" :model="formValidate" :rules="ruleValidate" :label-width="120">

						<div style='display:flex;width:100%'>

							<div style='width:50%'>

								<FormItem :label="$t('member.name')" prop="name"><!--姓名-->
									<Input v-model="formValidate.name" :placeholder="$t('member.name')"></Input>
								</FormItem>
								<FormItem :label="$t('member.mobile')" prop="mobile"><!--手机-->
									<Input v-model="formValidate.mobile" :placeholder="$t('member.mobile')"></Input>
								</FormItem>
								
								<FormItem label="会员卡" prop="crmCardName"><!--会员类型-->
									<span @click='crmCard'>
									<Input v-model="formValidate.crmCardName" :placeholder="$t('member.crmtype')"></Input>
									</span>
								</FormItem>
								<FormItem :label="$t('member.store')" ><!--店铺-->
									<span @click='clickStore'>
										<Input v-model="storeName" :placeholder="$t('member.store')"></Input>
									</span>
								</FormItem>
								<FormItem :label="$t('member.yuee')"><!--初始余额-->
									<InputNumber  v-model="chargeMoney" :min="0" :placeholder="$t('member.yuee')" @on-change="changeMoney" style="width:100%"></InputNumber >
								</FormItem>
								
							</div>

							<div style='width:50%'>
							<!-- 	<FormItem :label="$t('member.pss')" prop='password'>
									<Input v-model="formValidate.password" type='password' :placeholder="$t('member.pss')"></Input>
								</FormItem> -->
								<FormItem :label="$t('public.gender')" >
									<RadioGroup v-model="gender" @on-change="selsectedSex">
										<Radio label="男">
											<span>男</span><!--男-->
										</Radio>
										<Radio label="女">
											<span>女</span><!--女-->
										</Radio>
									</RadioGroup>
								</FormItem>
								<FormItem :label="$t('member.birsday')"><!--生日-->
									<DatePicker type="date" :options="optionsB" format="yyyy-MM-dd" style='width:100%' :placeholder="$t('member.birsday')" :value='birthday' @on-change="changeBirthday"></DatePicker>
								</FormItem>
								<FormItem :label="$t('member.DG')"><!--导购-->
									<div style="position:relative">
										<Input v-model="employeeName" :placeholder="$t('member.DG')" @on-keyup="changeInput"></Input>
										<span @click="selecteStore">
										<Icon type="ios-search" size="16" style='position:absolute;top:8px;right:8px;cursor:pointer'></Icon>
										</span>
										<div style="position:absolute;z-index:999;width:100%">
											<Table v-if='storeisshow1' border height='300' highlight-row :columns="storekey" :data="allStore" @on-row-click="ckrow1" @on-row-dblclick="dblclickDGsrow">
											</Table>
										</div>
									</div>
								</FormItem>

								<FormItem :label="$t('member.sxtime')" prop="endDate"><!--失效时间-->
									<DatePicker   type="date" :options="optionsBE" :placeholder="$t('member.sxtime')" style='width:100%' :value='formValidate.endDate' @on-change="changeEndDate"></DatePicker>
								</FormItem>
								
							</div>
						</div>
						<FormItem :label="$t('public.remark')" style='margin-top:10px'>
							<Input type='textarea' style='width:100%;margin-bottom:120px' v-model='remark' :placeholder="$t('public.remark')"></Input>
						</FormItem>
					</Form>

				</div>
				<!--修改-->
				<div class='right-right' v-if='xiugai'>
					<Form ref="formValidate1" :model="formValidate" :rules="ruleValidate" :label-width="120">

						<div style='display:flex;width:100%;height:100%'>
							<div style='width:50%'>
								<FormItem :label="$t('member.name')" prop="name"><!--姓名-->
									<Input v-model="formValidate.name" :placeholder="$t('member.name')"></Input>
								</FormItem>
								<FormItem :label="$t('member.mobile')" prop="mobile"><!--手机-->
									<Input v-model="formValidate.mobile" :placeholder="$t('member.mobile')"></Input>
								</FormItem>
								
								<FormItem label="会员卡" prop="crmCardName"><!--会员类型-->
									<span @click='crmCard'>
									<Input v-model="formValidate.crmCardName" :placeholder="$t('member.crmtype')"></Input>
									</span>
								</FormItem>
								<FormItem :label="$t('member.store')" ><!--店铺-->
									<span @click='clickStore'>
										<Input v-model="storeName" :placeholder="$t('member.store')"></Input>
									</span>
								</FormItem>
								
								
							</div>
							<div style='width:50%'>
								<FormItem :label="$t('public.gender')" >
									<RadioGroup v-model="gender" @on-change="selsectedSex">
										<Radio label="男">
											<span>男</span><!--男-->
										</Radio>
										<Radio label="女">
											<span>女</span><!--女-->
										</Radio>
									</RadioGroup>
								</FormItem>
								<FormItem :label="$t('member.birsday')"><!--生日-->
									<DatePicker type="date" :options="optionsB" format="yyyy-MM-dd" style='width:100%' :placeholder="$t('member.birsday')" :value='birthday' @on-change="changeBirthday"></DatePicker>
								</FormItem>
								<FormItem :label="$t('member.DG')"><!--导购-->
									<div style="position:relative">
										<Input v-model="employeeName" :placeholder="$t('member.DG')" @on-keyup="changeInput"></Input>
										<span @click="selecteStore">
										<Icon type="ios-search" size="16" style='position:absolute;top:8px;right:8px;cursor:pointer'></Icon>
										</span>
										<div style="position:absolute;z-index:999;width:100%">
											<Table v-if='storeisshow1' border height='300' highlight-row :columns="storekey" :data="allStore" @on-row-click="ckrow1" @on-row-dblclick="dblclickDGsrow">
											</Table>
										</div>
									</div>
								</FormItem>
								
								<FormItem :label="$t('member.sxtime')" prop="endDate"><!--失效时间-->
									<DatePicker :options="optionsBE"  type="date" :placeholder="$t('member.sxtime')" style='width:100%' :value='formValidate.endDate' @on-change="changeEndDate"></DatePicker>
								</FormItem>
								
							</div>
						</div>
						<FormItem :label="$t('public.remark')" style='margin-top:10px'>
							<Input type='textarea' style='width:100%;margin-bottom:120px' v-model='remark' :placeholder="$t('public.remark')"></Input>
						</FormItem>
					</Form>

				</div>
				<!--详情-->
				<!--详情明细订单页面-->
					<div class="right-content right-detail" ref="detail" style="display:none">
						<div >

						<div style='display:flex;margin: 0 20px;'>

							<img :src="crmDetail.photo" width='130' height='130' style='vertical-align:middle;margin-top: 26px;'>
							<div style='display:inline-block;vertical-align:middle;margin-left:20px'>
					<div  style='display:inline-block'>
						<div class="list-box list-box1">
							<span>{{$t('member.name')}} : </span><div>{{crmDetail.name}}</div><!--姓名-->
						</div>
						<div class="list-box list-box1">
						<span>{{$t('public.gender')}} : </span><div>{{crmDetail.gender=='男'?this.$t('public.man'):crmDetail.gender=='女'?this.$t('public.woman'):''}}</div>
						</div>

						<div class="list-box list-box1">
							<span>{{$t('member.DG')}} : </span><div>{{crmDetail.employeeName}}</div><!--导购-->
						</div>
					</div>
				<div style='display:inline-block;margin-left:20px'>
					<div class="list-box list-box1">
							<span> {{$t('member.mobile')}} : </span><div>{{crmDetail.mobile}}</div><!--手机-->
						</div>
					<div class="list-box list-box1">
							<span>{{$t('member.ye')}} : </span><!--账户余额-->
							<div style='color:#FF934D'>{{crmDetail.chargeMoney}}</div>
					</div>
					<div class="list-box list-box1" >
						<span>{{$t('member.jf')}}:</span> <div style='color:#FF934D'>{{crmDetail.dqjf}}</div><!--会员积分-->
					</div>
				</div>
				<div style='display:inline-block;margin-left:20px;vertical-align:top'>
					<div class="list-box list-box1" >
						<span>生日 : </span><div>{{birthday}}</div>

					</div>
					<div class="list-box list-box1" >
						<span>{{$t('member.level')}} : </span><div>{{crmDetail.level}}</div><!--会员卡等级-->

					</div>
					<!-- <div class="list-box list-box1">
						<span>{{$t('member.store')}} : </span><div>{{crmDetail.storeName}}</div>
					</div> -->
					<div class="list-box list-box1">
						<span>{{$t('public.remark')}}: </span><div>{{crmDetail.remark}}</div>
					</div>

				</div>
				</div>
						</div>
					
					<!--**********下方数据***********-->
								<div class="detail-bottom">
									<!--状态-->
										<!-- <div class="lanren" :class="{bgd1:crmDetail.status==1,bgd3:crmDetail.status==0,bgd4:crmDetail.status==7}">
										<span>{{crmDetail.statusDesc}}</span>
										</div>​ -->
									<div class="detail-title-mark">
										<div v-for="(item,index) in titles" :key='index' class="detail-title" @click="addborder(index)" :class="{bor:index==num2}">
											{{item}}
										</div>
									</div>

									<!--订单-->
									<div v-if="num2==0" class="detail-public">
										<!--订单表格数据-->
										<div class="table">
											<Table border  :columns="orderDateKey" :data="orderdataList" ></Table>
											<!--底部的分页-->
											<div class="page-box" v-if='total>10' style="margin-bottom:120px">
												<Page :total="total" show-total size='small' :pageSize='pageSize'  @on-change="getData" @on-page-size-change="changePageSize"></Page>
											</div>
										</div>
									</div>
									<!--积分-->
									<div v-if="num2==1" class="detail-public">

										<div class="table">
											<Table border  :columns="jfDateKey" :data="jfdataList" ></Table>
											<!--底部的分页-->
											<div class="page-box" v-if='jftotal>10' style="margin-bottom:120px">
												<Page :total="jftotal" size='small' show-total  :pageSize='jfpageSize'  @on-change="jfgetData" @on-page-size-change="jfchangePageSize"></Page>
											</div>
										</div>
									</div>
									<!--充值历史-->
									<div v-if='num2==2' class="detail-public">
										<div class="table">
											<Table border  :columns="czDateKey" :data="czdataList" ></Table>
											<!--底部的分页-->
											<div class="page-box" v-if='cztotal>10' style="margin-bottom:120px">
												<Page :total="cztotal" size='small' show-total  :pageSize='czpageSize'  @on-change="czgetData" @on-page-size-change="czchangePageSize"></Page>
											</div>
										</div>
									</div>
									<!--消费历史-->
									<div v-if='num2==3' class="detail-public">
										<div class="table">
											<Table border  :columns="xfDateKey" :data="xfdataList" ></Table>
											<!--底部的分页-->
											<div class="page-box" v-if='xftotal>10' style="margin-bottom:120px">
												<Page :total="xftotal" size='small' show-total  :pageSize='xfpageSize'  @on-change="xfgetData" @on-page-size-change="xfchangePageSize"></Page>
											</div>
										</div>
									</div>
									<div v-if='num2==4' class="detail-public">
										<div class='addRess' style='width:98%;margin-top:20px'>
											<!--头部-->
											<div class='addRess-top'>
												<div  class='address-left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
												<div class='addressTitle'>{{$t('public.address')}}</div>
												<div style='color:#4E7DDD;cursor:pointer' class='addressbtn0' @click='addr'>{{$t('public.addnew')}}</div>
											</div>
											<div class='addRess-top1'>
												<div class='address-left'>{{$t('public.deaddress')}}</div>
												<div class='title-ht' style='display: flex;width:100%;font-weight:600;justify-content: space-around;'>
												<span>{{$t('public.xxaddress1')}}</span>
												<span >{{$t('public.xxaddress')}}</span>
												<span>{{$t('sales.client.contact')}}</span>
												<span>{{$t('sales.client.contactMobile')}}</span>
												<span>{{$t('sales.client.contactPhone')}}</span>
												</div>
												<div style='color:#4E7DDD;' class='addressbtn'>{{$t('public.action')}}</div>
											</div>
											<!--地址列表-->
											<div class='addRess-top1' v-for='(i,index) in AllAddress' :key='index'>
												<div class='address-left'>
												<Checkbox :value="i.default" @on-change='defaultAddress(i.id)'></Checkbox>
												</div>
												<div class='addressTitle title-ht' style='display:flex;;align-items: center;width: 100%;justify-content: space-around;'>

												<span>{{i.province}}  {{i.city}} {{i.county}}</span>

												<span style='word-wrap: break-word;'>{{i.address}}</span>
												<span>{{i.name}}</span>

												<span>{{i.mobile}}</span>
												<span >{{i.phone}}</span>
												</div>
												<div style='color:#72C89E;cursor:pointer' class='addressbtn' >

												<span @click='editAddressBtn(i.id)'>{{$t('public.EditBtn')}}</span>
												<span @click='deleteAddressBtn(i.id)' style='color:#d53c39'>删除</span>

												</div>
											</div>
										</div>
									</div>
								</div>
						</div>

					</div>
			</div>
		</div>
		<!--选择员工弹出框-->
		<Modal v-model="storeisshow" width="660px">
			<p slot="header" style="height:30px;line-height:30px">

				<span>{{$t('member.choose')}}</span><!--选择导购-->
			</p>
			<div style="position:relative;text-align:center;width:100%;height:35px;line-height:35px;display:flex;">
				<Input v-model='ygkeyword'  :placeholder="$t('public.codeandname')" style="padding:2px 0" @on-enter="entersearchYG"></Input>
				<span @click="searchYG">
					<Icon type="search" size="16" style="display:inline-block;position:absolute;top:10px;right:18px;z-index:9" ></Icon>
				</span>
			</div>
			<div slot="footer" style='margin-top:-10px'>
				<!--员工表格-->
				<Table  border height='300' highlight-row :columns="storekey" :data="allStore" @on-row-click="ckrow" @on-row-dblclick="dblclickDGsrow">
				</Table>
				<!--分页-->
	            <div class="page-box" style="text-align:left">
				 <Page :total="ygtotal" :pageSize='ygpageSize' show-total size="small" @on-change="getygData" @on-page-size-change="changeygPageSize"></Page>
				</div>
				<div class='title'>
					<div style='color:#D15151;font-size:14px'>
						<!-- <Icon type="plus" style='margin-right:5px'></Icon>
						<span >添加员工</span> -->
					</div>
					<div>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelStore'><Icon type="close" style="margin-right:5px;" ></Icon>{{$t('public.cancel')}}</Button>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#00A7F5;color:#fff" @click="eysure"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>{{$t('public.sure')}}</Button>
					</div>
				</div>
			</div>
		</Modal>
		<!--选择会员卡-->
		<Modal v-model="crmCardisshow" width="660px">
			<p slot="header" style="height:30px;line-height:30px">

				<span>{{$t('member.chooseC')}}</span>
			</p>
			<div style="position:relative;text-align:center;width:100%;height:35px;line-height:35px;display:flex;">
				<Input  :placeholder="$t('public.codeandname')" style="padding:2px 0" v-model='cardKeyword' @on-enter='cardEnter'></Input>
				<span @click='clicksearch'>
					<Icon type="search" size="16" style="display:inline-block;position:absolute;top:10px;right:18px;z-index:9;cursor:pointer" ></Icon>
				</span>
			</div>
			<div slot="footer" style='margin-top:-10px'>
				<!--会员卡表格-->
				<Table  border height='300' highlight-row :columns="crmCardkey" :data="crmCardData" @on-row-click="crmrow"@on-row-dblclick="dblcrmrow">
				</Table>
				<div class="page-box">
					<Page v-if='cardtotal!=0' :total="cardtotal" show-total size="small" :pageSize='cardpageSize'  @on-change="cardgetData" @on-page-size-change="cardchangePageSize"></Page>
				</div>
				<div class='title'>
					<div style='color:#D15151;font-size:14px'>
					<!-- 	<Icon type="plus" style='margin-right:5px'></Icon>
						<span >添加会员卡</span> -->
					</div>
					<div>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelStore'><Icon type="close" style="margin-right:5px;" ></Icon>{{$t('public.cancel')}}</Button>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#00A7F5;color:#fff" @click="sureStore"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>{{$t('public.sure')}}</Button>
					</div>
				</div>
			</div>
		</Modal>
		<!--店铺-->
		<Modal v-model="storeNameisshow" width="660px">
			<p slot="header" style="height:30px;line-height:30px">

				<span>{{$t('member.store')}}</span>
			</p>
			<div style="position:relative;text-align:center;width:100%;height:35px;line-height:35px;display:flex;">
				<Input  :placeholder="$t('public.codeandname')" style="padding:2px 0" v-model='storekeyword' @on-enter='storeEnter'></Input>
				<span @click='clicksearchstore'>
					<Icon type="search" size="16" style="display:inline-block;position:absolute;top:10px;right:18px;z-index:9;cursor:pointer" ></Icon>
				</span>
			</div>
			<div slot="footer" style='margin-top:-10px'>
				<!--会员表格-->
				<Table  border height='300' highlight-row :columns="storekey1" :data="storeData" @on-row-click="crmrowstore" @on-row-dblclick="dblcrmrowstore">
				</Table>
				<div class="page-box">
					<Page v-if='storetotal1!=0' :total="storetotal1" show-total size="small" :pageSize='storepageSize1'  @on-change="storegetData" @on-page-size-change="storechangePageSize"></Page>
				</div>
				<div class='title'>
					<div style='color:#D15151;font-size:14px'>
					<!-- 	<Icon type="plus" style='margin-right:5px'></Icon>
						<span >添加会员卡</span> -->
					</div>
					<div>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelStorestore'><Icon type="close" style="margin-right:5px;" ></Icon>{{$t('public.cancel')}}</Button>
						<Button shape="circle" type="ghost" style="display:inline-block;background:#00A7F5;color:#fff" @click="sureStorestore"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>{{$t('public.sure')}}</Button>
					</div>
				</div>
			</div>
		</Modal>
		<!--重置密码-->
		<Modal v-model="passIsshow" width="360"   :mask-closable='false' :closable='false'>
			<p slot="header" style="height:30px;line-height:30px">
	          <span>密码重置：{{formValidate.name}}</span>
	        </p>
			<Form ref="loginformValidate" :model="loginformValidate" :rules="loginruleValidate" :label-width="80">
				<FormItem :label="$t('login.Rpassword')" prop="rpass">
					<Input type='password' v-model="loginformValidate.rpass" :placeholder="$t('login.RpasswordPlaceholder')"></Input>
				</FormItem>
				<FormItem :label="$t('login.RaginPassword')" prop="repeatpass">
					<Input type='password' v-model="loginformValidate.repeatpass" :placeholder="$t('login.RaginPasswordPlaceholder')" ></Input>
				</FormItem>
			</Form>
			<div slot="footer">
				<div>
					<Button shape="circle"
					type="ghost"
					style="display:inline-block;background:#ACACAC;border:none;color:#fff"
					@click='cancelPass'><Icon type="close" style="margin-right:5px;" >
						</Icon>{{$t('public.cancel')}}</Button>
					<Button shape="circle" type="ghost"
					style="display:inline-block;background:#00A7F5;color:#fff"
					@click="surePss('loginformValidate')"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff">
						</Icon>{{$t('public.sure')}}</Button>
				</div>
			</div>
		</Modal>
		 <!--保存地址-->
   	<Modal v-model="saveaddressisshow" width="560px" >
        <p slot="header" style="height:30px;line-height:30px">
          <span>{{$t('public.addnew')}}</span>
        </p>
         <Form ref="xiaoshousave" :model="xiaoshouformValidate" :rules="xiaoshouruleValidate" :label-width="80" >
         	<FormItem label="地址" prop="addressProvince">
         		<el-cascader
		          filterable
		              expand-trigger="click"
		              :options="cityInfo"
		              v-model="selectedOptions3"
		              @change="handleChange1"
					 :placeholder="$t('public.pleseSelect')"
					  style="width:400px">
		        </el-cascader>
         	</FormItem>
         	<FormItem label="详细地址" prop="addressAddress">
         		 <Input type="text" v-model="xiaoshouformValidate.addressAddress" placeholder="详细地址" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="联系人" prop="addressName">
         		 <Input type="text" v-model="xiaoshouformValidate.addressName" placeholder="联系人" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="手机号" prop="addressMobile">
         		 <Input type="text" v-model="xiaoshouformValidate.addressMobile" placeholder="手机号" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="电话">
         		 <Input type="text" v-model="xiaoshouformValidate.addressPhone" placeholder="电话" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="默认">
         		<Checkbox v-model='isdefault' @on-change="changeisdefault"></Checkbox>
         	</FormItem>
         </Form>
        <div slot="footer">
          <div class='title'>
            <div style='color:#D15151;font-size:14px'>
              </div>
            <div style='margin-top:10px'>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelAddress'><Icon type="close" style="margin-right:5px;" ></Icon>{{$t('public.cancel')}}</Button>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#3b77e3;color:#fff" @click="saveAddRess('xiaoshousave')" ><i class="el-icon-edit" style=";margin-right:5px;"></i>{{$t('public.SaveBtn')}}</Button>
            </div>
          </div>
        </div>
    </Modal>
      <!--修改地址-->
    <Modal v-model="addressisshow" width="560px" >
        <p slot="header" style="height:30px;line-height:30px">
          <span>{{$t('public.EditBtn')}}</span>
        </p>
        <Form ref="xiaoshousaveE" :model="xiaoshouformValidate" :rules="xiaoshouruleValidate" :label-width="80" >
         	<FormItem label="地址" prop="addressProvince">
         		<el-cascader
		          	filterable
		              expand-trigger="click"
		              :options="cityInfo"
		              v-model="selectedOptions3"
		              @change="handleChange1">
		            </el-cascader>
         	</FormItem>
         	<FormItem label="详细地址" prop="addressAddress">
         		 <Input type="text" v-model="xiaoshouformValidate.addressAddress" placeholder="详细地址" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="联系人" prop="addressName">
         		 <Input type="text" v-model="xiaoshouformValidate.addressName" placeholder="联系人" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="手机号" prop="addressMobile">
         		 <Input type="text" v-model="xiaoshouformValidate.addressMobile" placeholder="手机号" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="电话">
         		 <Input type="text" v-model="xiaoshouformValidate.addressPhone" placeholder="电话" style="width:400px"></Input>
         	</FormItem>
         	<FormItem label="默认">
         		<Checkbox v-model='isdefault' @on-change="changeisdefault"></Checkbox>
         	</FormItem>
         </Form>
        <div slot="footer">

          <div class='title'>
            <div style='color:#D15151;font-size:14px'>
              </div>
            <div style='margin-top:10px'>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelAddress'><Icon type="close" style="margin-right:5px;" ></Icon>{{$t('public.cancel')}}</Button>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#40ca98;color:#fff" @click="editAddress('xiaoshousaveE')" ><i class="el-icon-edit" style=";margin-right:5px;"></i>{{$t('public.EditBtn')}}</Button>
            </div>
          </div>
        </div>
   	</Modal>
		<div class='tot'>
            <span>共<span style='color:#ff0000'> {{totalcl}} </span>条</span>
            <span>当前第<span style='color:#ff0000'> {{current}} </span>页</span>
     </div>
	</div>
</template>
<script type="text/javascript">
import LoadUrl from '@/components/common/actionLoad'
import { regionData,CodeToText,TextToCode} from 'element-china-area-data'
	export default {
		data (){
			const validatePass = (rule, value, callback) => {
                if (value === '') {
                    callback(new Error('请输入密码'));
                } else {
                    if (this.loginformValidate.repeatpass !== '') {
                        // 对第二个密码框单独验证
                        this.$refs.loginformValidate.validateField('repeatpass');
                    }
                    callback();
                }
            };
            const validatePassCheck = (rule, value, callback) => {
                if (value === '') {
                    callback(new Error('请再次输入密码'));
                } else if (value !== this.loginformValidate.rpass) {

                    callback(new Error(this.$t('login.oneOrTwoPss')));
                } else {
                    callback();
                }
            };
			return{
				optionsBE:this.optionsB,//失效时间
				//生日(最小18岁)
				optionsB:this.optionsBirthday,
				startisstop:false,
				startisshow:false,
				xiaoshouformValidate:{
					addressAddress:"",
					addressName:"",
					addressMobile:"",
					addressPhone:"",
					addressProvince:"",
				},
				xiaoshouruleValidate:{
					addressProvince:[ { required: true, message: '地址不能为空', trigger: 'change' }],
					addressName:[ { required: true, message: '联系人不能为空', trigger: 'blur' }],
					addressMobile:[{ required: true, message: '手机号不能为空', trigger: 'blur' },{ pattern: /^1[3|4|5|7|8][0-9]{9}$/, message: '请输入正确的手机号码' }],
					addressAddress:[{ required: true, message: '详细地址不能为空', trigger: 'blur' }]

				},
				
				isdefault:false,//保存是是否设置为默认地址
				addressIndex:-1,
        		saveaddressisshow:false,//保存的弹框
				addressisshow:false,//地址修改的弹框
				selectedOptions3:[],
				
				AllAddress:[],//地址列表
        		addressId:'',//地址ID
				passIsshow:false,
				loginformValidate:{
					rpass:'',//密码
					repeatpass:'',//确认密码
				},
				loginruleValidate:{
					rpass: [
					{ required: true, message: this.$t('login.RpasswordPlaceholder'), trigger: 'blur' },
					{ pattern: /^[0-9a-zA-Z]+$/, message: this.$t('login.RaginPasswordOnum'),trigger: 'blur' },

                    { validator: validatePass, trigger: 'blur' },

                    ],
					repeatpass: [
					{ required: true, message: this.$t('login.RaginPasswordPlaceholder'), trigger: 'blur' },
					{ pattern: /^[0-9a-zA-Z]+$/, message: this.$t('login.RaginPasswordOnum')},

                    { validator: validatePassCheck, trigger: 'blur' },

                    ],

				},
				searchKeyword:"",
				storeName:'',//店铺名
				storeNameisshow:false,
				storeId:'',//店铺编号
				storeData:[],
				storekey1:[
					{
						title:this.$t('member.code'),//编码
						width:180,
						key:"code",
					},
					{
						title:this.$t('member.name'),//名称
						width:180,
						key:"name",
					},
					{
						title:this.$t('purchase.supplier.contract'),//联系人
						width:180,
						key:"person",
					},
					{
						title:this.$t('purchase.supplier.Raddress'),//地址
						width:180,
						key:"Aaddress",
					},
				],
				storekeyword:"",
				storeObj:{},
				storetotal1:0,
				storepageSize1:0,
				cardKeyword:"",//会员卡关键字搜索
				formValidate:{
					name:"",//会员名称
					password:'',//会员登陆密码
					mobile:'',//会员手机
					crmCardName:'',//会员卡名称
					endDate:"",//失效时间
					discount:1,//折扣
					address:"",
					province:"",//省
					city:"",//市
					district:"",//区
					identityNo:"",//证件号
					userDef01:"",//工作时间
					userDef02:"",//常用支付
					userDef03:"",//员工数量
					userDef04:"",//商品数
					userDef05:"",//拥有店铺数
					userDef06:"",//营业
				},
				ruleValidate:{
					name:[{ required: true, message:this.$t('finance.nameEmpty'), trigger: 'blur' },
					{ pattern:/^[A-Za-z\d_\-\u4e00-\u9fa5]{1,20}$/, message: '存在非法字符或超过指定长度20个字符' }],
					province:[{ required: true, message:this.$t('member.addressEp'), trigger: 'change' }],
					password:[{ required: true, message:this.$t('public.pssEmpty'), trigger: 'blur' }],
					
					mobile:[{ required: true,  message: this.$t('login.RmobilePlaceholder'), trigger: 'blur' },
					
					 { pattern: /^1[3|4|5|7|8][0-9]{9}$/, message: '请输入正确的手机号码' }
					],
					discount:[{ pattern: /^((0\.[1-9]{1})|(([1-9]{1})(\.\d{1})?))$/, message: this.$t("member.zk"), trigger: 'blur'  }]

				},
				totalcl:0,
				pageSizecl:0,
				logoUrl:LoadUrl.httpPrefix.Url+'file/action/upload/image/url?c=会员图片&uid='+this.$store.state.common.token,//图片上传地址
				CodeToText:CodeToText,//code转为Text
				TextToCode:TextToCode,//Text转为code
				cityInfo:regionData,//地址数据
				selectedOptions2:[],//绑定的数据
				ygtotal:0,
				ygpageSize:0,
				ygkeyword:'',//搜索关键词
				addoredit:this.$t('member.add'),//"新增会员",
				leftphoto:true,
				xiugai:false,
				current:1,
				height:'',
				numIndex:0,
				indexId:'',
				addText:true,
				editshow:false,
				storeisshow:false,
				storeisshow1:false,
				crmCardisshow:false,
				storekeyword:'',
				cartype:'',
				num2:0,
				orderdataList:[],
				 pageSize:0,
				 total:0,
				 // titles:["订单","积分","充值历史","消费历史",'会员地址'],
				 titles:[this.$t('member.order'),this.$t('member.jf'),this.$t('member.czHistory'),this.$t('member.xfHistory'),this.$t('member.memberAddress')],
				 //消费历史
				 xfdataList:[],
				 xfpageSize:0,
				 xftotal:0,
				 xfDateKey:[

				 	{
				 		title:this.$t('member.code'),//会员编码
				 		key:"crmCode"
				 	},
				 	{
				 		title:this.$t('member.orderje'),//消费金额
				 		key:"amount"
				 	},
				 	{
				 		title:this.$t('member.payType'),//title:"支付方式",
				 		key:"payType"
				 	},
				 	{
				 		title:this.$t('member.orderTime'),//title:"消费时间",
				 		key:"createTime"
				 	},
				 	// {
				 	// 	title:this.$t('public.status'),//title:"状态",
				 	// 	key:"statusDesc"
				 	// },
				 ],

				 //充值历史
				 cztotal:0,
				 czpageSize:0,
				czDateKey:[
				 	{
				 		title:this.$t('member.orderNo'),//订单编号
				 		key:"payNo"
				 	},
				 	{
				 		title:this.$t('member.code'),//会员编码
				 		key:"crmCode"
				 	},
				 	{
				 		title:this.$t('member.czje'),//充值金额"
				 		key:"amount"
				 	},

				 	{
				 		title:this.$t('member.czTime'),//title:"充值时间",
				 		key:"createTime"
				 	},
				 	// {
				 	// 	title:this.$t('public.status'),//title:"状态",
				 	// 	key:"statusDesc"
				 	// },
				 ],
				 czdataList:[],
				 //订单历史
				orderDateKey:[

					{
						title:this.$t('member.orderNo'),//订单编号

						key:"orderNo"
					},
					{
						title:this.$t('member.orderje'),//消费金额

						key:"amount"
					},
					{
						title:this.$t('member.orderTime'),//title:"消费时间",

						key:"createTime"
					},
					{
						title:this.$t('public.status'),//title:"状态",

						key:"statusDesc"
					},

				],
				jfpageSize:0,
				jftotal:0,
				jfdataList:[],
				//积分历史
				jfDateKey:[
					{
						title:this.$t('member.code'),//会员编码

						key:"crmCode"
					},
					{
						title:this.$t('member.store'),//店铺

						key:"storeName"
					},
					{
						title:this.$t('member.name'),//会员

						key:"crmName"
					},
					{
						title:"jf",

						key:"jf"
					},
					{
						title:"qcsl",

						key:"qcsl"
					},
					{
						title:"qcje",

						key:"qcje"
					},
					{
						title:"zjfx",

						key:"zjfx"
					},
					{
						title:"zj",

						key:"zj"
					},
					{
						title:"sl",

						key:"sl"
					},


				],
				crmDetail:{},
				crmCardData:[],
				cardpageSize:0,
				cardtotal:0,
				crmCardkey:[
			            {
			               title:this.$t('member.name'),//会员
			                key:'name'
			            },
			            {
			                title:'消费金额',
			                key:'consumptionAmount'
			            },
			            {
			                title:this.$t('member.yj'),//押金
			                key:'deposit'
			            },
			            {
			                title:'是否默认',
			                key:'defaultValueDesc'
			            },
			            {
			                title:this.$t('member.disc'),//'折扣',
			                key:'discount'
			            },
			            {
			                title:'期限',
			                key:'timeMonth'
			            },
			            {
			                title:this.$t('member.crmintegral.usefw'),//'使用范围',
			                key:'useTypeDesc'
			            }
			          ],
				allStore:[],
				storekey:[
					{
						title:"头像",
						width:80,
						key:"headPic",
						render:(h, params) =>{
		                  	return h('div',[
			                    h('img',{
			                        attrs:{
			                          src:params.row.headPic
			                        },
			                        style:{
			                          width:'40px',
			                          height:'40px'
			                        }
			                    })
		                    ])
		                }
					},
					{
						title:"员工编号",
						width:180,
						key:"code"
					},
					{
						title:"员工姓名",
						width:180,
						key:"name"
					},

					{
						title:"性别",
						width:80,
						key:"gender",
						render:(h,params)=>{
		              return h('div',{
		                  style:{
		                    color:params.row.gender=="男"?'#40ca98':params.row.gender=="女"?'#FF934D':''
		                  }
		                },params.row.gender)
		              }
					},
					
					{
						title:"手机号",
						width:180,
						key:"phone"
					}

				],
				Allcrm:[],
				uid: this.$store.state.common.token,
				user:this.$store.state.common.user,
				valueT:1,
				orderListname:[
						{
			                label:this.$t('public.all'),//
			                value:0
			            },
			            {
			                label:'正常',//
			                value:1
			            },
			            {
			                label:"拉黑",
			                value:9
			            },

				],
				crmCardObj:{},
				
				crmCardId:'',//会员卡id
				photo:'',//会员头像
				code:'',//会员号
				name:'',//会员名
				mobile:'',//手机号
				address:'',//地址
				remark:'',
				province:'',//省
				city:'',//市
				district:'',//区
				addressDetail:'',//详细地址
				gender:'男',//
				birthday:new Date(new Date().getFullYear()-18,0,0),
				dqjf:0,//初始积分
				chargeMoney:0,//初始余额
				eysureObj:{},
				employeeId:'',
				employeeName:'',
			}
		},
		methods:{
			//余额
			changeMoney(s){
				this.chargeMoney=s
			},
			//点击新增地址弹框
			addr(){
				this.xiaoshouformValidate.addressName=''//联系人
				this.xiaoshouformValidate.addressPhone=''//联系电话
				this.xiaoshouformValidate.addressMobile=''//联系电话
				this.xiaoshouformValidate.addressProvince=''//省
				this.addressCity=''//市
				this.addressCountry=''//区
				this.xiaoshouformValidate.addressAddress=''//详细地址
				this.selectedOptions3=[]
				this.isdefault=false//详细地址
				this.saveaddressisshow=true
			},
			//常用地址省市区
			handleChange1(arr){
				this.xiaoshouformValidate.addressProvince = this.CodeToText[arr[0]]
				this.addressCity =this.CodeToText[arr[1]]
				this.addressCountry = this.CodeToText[arr[2]]
			},
			//保存是点击默认地址选中
			changeisdefault(v){
				this.isdefault=v
			},
			//保存地址
			saveAddRess(name){
				if(this.id==''){
				this.$notify({
						title:"",//
						message: this.$t('public.scrm'),
						type: 'error',
						position: 'bottom-right'
					});
				}else{
					this.$refs[name].validate((valid) => {
						if(valid){
							this.axios.post('crmaddress/add?uid='+this.uid,{
								crmId:this.indexId,
								name:this.xiaoshouformValidate.addressName,//联系人
								phone:this.xiaoshouformValidate.addressPhone,//联系电话
								mobile:this.xiaoshouformValidate.addressMobile,//联系手机
								province:this.xiaoshouformValidate.addressProvince,//省
								city:this.addressCity,//市
								county:this.addressCountry ,//区
								address:this.xiaoshouformValidate.addressAddress,//详细地址
								default:this.isdefault//是否设置为默认地址
							}).then(res=>{
								if(res.data.status==200){
									this.$notify({
									title:"",//
									message: this.$t('public.SaveSuccess'),//'修改地址成功',
									type: 'success',
									position: 'bottom-right'
								});
									this.getAllAddress(this.indexId)
									this.xiaoshouformValidate.addressName=''//联系人
									this.xiaoshouformValidate.addressPhone=''//联系电话
									this.xiaoshouformValidate.addressMobile=''//联系电话
									this.xiaoshouformValidate.addressProvince=''//省
									this.addressCity=''//市
									this.addressCountry=''//区
									this.xiaoshouformValidate.addressAddress=''//详细地址
									this.selectedOptions3=[]
									this.isdefault=false//详细地址
									this.saveaddressisshow=false
								}else{

								this.$notify({
									title:"",//
									message:res.data.errorMessage,
									type: 'error',
									position: 'bottom-right'
								});
								}
							})
						}
					})
				
				}

			},
			//点击修改获取id详情
			editAddressBtn(id){
				this.axios.get('crmaddress/get/'+id+'?uid='+this.uid).then(res=>{
				if(res.data.status==200){
					console.log(res.data.rows)
					let data=res.data.rows
					this.addressId=id
					this.xiaoshouformValidate.addressName=data.name
					this.xiaoshouformValidate.addressPhone=data.phone
					this.xiaoshouformValidate.addressMobile=data.mobile
					this.xiaoshouformValidate.addressProvince=data.province
					this.addressCity=data.city
					this.addressCountry=data.county
					this.xiaoshouformValidate.addressAddress=data.address
					this.isdefault=data.default
					// //接收地址
					if(res.data.rows.province==null || res.data.rows.city==null || res.data.rows.county==null){
						this.selectedOptions2=[]
					}else if(data.province==''|| data.city=='' || data.county==''){
						this.selectedOptions3=[]
					}else{
						//转为code
						console.log(this.selectedOptions3)
						this.xiaoshouformValidate.addressProvince=res.data.rows.province
						this.addressCity=res.data.rows.city
						this.addressCountry=res.data.rows.county
						this.selectedOptions3=[this.TextToCode[this.xiaoshouformValidate.addressProvince].code,this.TextToCode[this.xiaoshouformValidate.addressProvince][this.addressCity].code,this.TextToCode[this.xiaoshouformValidate.addressProvince][this.addressCity][this.addressCountry].code]

					}

				}
				})

				this.addressisshow=true

			},
			//删除地址paddress/delete/23
			deleteAddressBtn(id){
				this.axios.delete('crmaddress/delete/'+id+'?uid='+this.uid).then(res=>{
				if(res.data.status==200){
					this.getAllAddress(this.indexId )
					this.$notify({
					title:"",//
						message:this.$t('public.deleteSuccess') ,//'删除地址成功',
						type: 'success',
						position: 'bottom-right'
					});
				}else{
					this.$notify({
					title:"",//
						message: res.data.errorMessage,
						type: 'error',
						position: 'bottom-right'
					});
				}
				})
			},
			//执行修改POST /crmaddress/add 新增
			editAddress(name){
				this.$refs[name].validate((valid) => {
					if(valid){
						this.axios.put('crmaddress/update?uid='+this.uid,{
								id:this.addressId,
								name:this.xiaoshouformValidate.addressName,//联系人
								phone:this.xiaoshouformValidate.addressPhone,//联系电话
								mobile:this.xiaoshouformValidate.addressMobile,//联系电话
								province:this.xiaoshouformValidate.addressProvince,//省
								default:this.isdefault,
								county:this.addressCountry,
								city:this.addressCity,//市

								address:this.xiaoshouformValidate.addressAddress,//详细地址
							}).then(res=>{
							if(res.data.status==200){
								this.$notify({
									title:"",//
									message: this.$t('public.editSuccess'),//'修改地址成功',
									type: 'success',
									position: 'bottom-right'
								});
								this.getAllAddress(this.indexId)
								this.addressisshow=false
							}else{
								this.$notify({
									title:"",//
									message: res.data.errorMessage,
									type: 'error',
									position: 'bottom-right'
								});
							}
						})
					}
				})
				
			},
			//取消修改地址
			cancelAddress(){
				this.addressisshow=false
				this.saveaddressisshow=false
			},
			//默认地址选中
			defaultAddress(id){
				this.addressId=id
				this.axios.get('crmaddress/default/'+id+'?uid='+this.uid).then(res=>{
				if(res.data.status==200){
					this.getAllAddress(this.indexId)//设置默认地址后刷新地址列表
				}
				})

			},
			//获取地址列表
			getAllAddress(id){
				this.axios.get('crmaddress/query/'+id+'?uid='+this.uid).then(res=>{
				if(res.data.status==200){
					//console.log(res.data.rows)
					this.AllAddress=res.data.rows
				}
				})
			},
			//点击新增
			add(){
				this.addoredit=this.$t('member.add')//'新增会员'
				this.addText = true
				this.xiugai=false
				this.leftphoto=true
				this.$refs.detail.style.display='none'
				this.code=''
				this.formValidate.crmCardName=''
				this.crmCardId=''
				this.photo=''
				this.formValidate.name=''//会员名
				this.formValidate.mobile='' //手机号
				this.employeeName=''
				this.employeeId=''
				this.formValidate.address=''//地址
				this.chargeMoney=0
				this.storeName=''
				this.storeId=''
				this.gender='男'
				this.dqjf=''
				this.formValidate.password=''
				this.remark=''
				this.formValidate.province=''//省
				this.formValidate.city=''//市
				this.formValidate.district=''//区
				this.selectedOptions2=[]
				this.formValidate.discount=''
				this.birthday=new Date(new Date().getFullYear()-18,0,0)
				this.addressDetail=''//详细地址
				this.formValidate.identityNo=''//证件号
				this.formValidate.yye=''//营业金额
				this.formValidate.house=''
				this.employeeName= this.user.name//默认当前登录者为导购名称
				this.employeeId = this.user.id//默认当前登录者为Id
				this.storeisshow=false
				this.getCardList()
			},
			//点击新增取消
			addCancel(){
				this.add()
			},
			//会员卡清单
	        getCardList(){
	            this.axios.get('crmlevel/query?uid='+this.uid).then((res)=>{
	                console.log(res)
	                if(res.data.status==200){
	                    this.crmCardData=res.data.rows
	                    this.cardpageSize=res.data.pageSize
	                    this.cardtotal=res.data.total
	                    this.crmCardData.forEach(x=>{
	                    	if(x.defaultValue){
	                    		x.defaultValueDesc="是"
	                    		this.formValidate.crmCardName= x.name
								this.crmCardId = x.id
	                    	}else{
	                    		x.defaultValueDesc="否"
	                    	}
	                    })
	                }
	            })
	        },
	        //点击选卡
	        crmCard(){

	        	this.crmCardisshow = true
	        	this.getCardList()
	        },
			//新建点击完成
			saveCgInfo(name){
				this.$refs[name].validate((valid) => {
					if(valid){
						this.axios.post('/crm/add?uid='+this.uid,{
							code:this.code,
							level:this.formValidate.crmCardName,//等级名称
							levelId:this.crmCardId,//等级id
							photo:this.photo,//'头像
							name:this.formValidate.name,//会员名
							mobile:this.formValidate.mobile,//手机号
							employeeId:this.employeeId,//导购id
							employeeName:this.employeeName,//导购名称
							storeName:this.storeName,//店铺名称
							storeId:this.storeId,
							chargeMoney:this.chargeMoney,//初始金额
							gender:this.gender,//性别
							// password:this.formValidate.password,//密码
							birthday:this.birthday,//生日
							endDate:this.formValidate.endDate,//失效时间
							identityNo:this.formValidate.identityNo,//证件号
							userDef01:this.formValidate.userDef01,
							userDef02:this.formValidate.userDef02,
							userDef03:this.formValidate.userDef03,
							userDef04:this.formValidate.userDef04,
							userDef05:this.formValidate.userDef05,
							userDef06:this.formValidate.userDef06,
					}).then((res)=>{
						console.log(res)
						if(res.data.status==200){

							this.$notify({
						        title:"",//
						        message: this.$t('member.addnew'),//'新建会员成功',
						        type: 'success',
						        position: 'bottom-right'
					        });
					        this.employeeName= this.user.name//默认当前登录者为导购名称
							this.employeeId = this.user.id//默认当前登录者为Id
							this.code=''
							this.formValidate.crmCardName=''
							this.crmCardId=''
							this.photo=''
							this.formValidate.name=''//会员名
							this.formValidate.mobile='' //手机号
							this.email=''
							this.employeeName=''
							this.employeeId=''
							this.formValidate.address=''//地址
							this.formValidate.province=''//省
							this.formValidate.city=''//市
							this.formValidate.district=''//区
							this.storeName=''
							this.storeId=''
							this.gender='男'
							this.qq=''
							this.formValidate.password=''
							this.dqjf='',
							this.birthday=new Date(new Date().getFullYear()-18,0,0)
							this.chargeMoney=0
							this.selectedOptions2=[]
							this.formValidate.identityNo=''//证件号
							this.formValidate.userDef01=''
							this.formValidate.userDef02=''
							this.formValidate.userDef03=''
							this.formValidate.userDef04=''
							this.formValidate.userDef05=''
							this.formValidate.userDef06=''

							this.getMentList(this.valueT)
							this.getCardList()
						}else{
							this.$notify({
						        title:"",//
						        message: res.data.errorMessage,
						        type: 'error',
						        position: 'bottom-right'
					        });
						}
					})
					}
				})


			},
			//取消修改
			editCancel(){
				this.code=''
				this.formValidate.crmCardName=''
				this.crmCardId=''
				this.photo=''
				this.formValidate.name=''//会员名
				this.formValidate.mobile='' //手机号
				this.email=''
				this.formValidate.address=''//地址
				this.formValidate.province=''//省
				this.formValidate.city=''//市
				this.formValidate.district=''//区
				this.storeName=''
				this.storeId=''
				this.gender='男'
				this.qq=''
				this.formValidate.password=''
				this.dqjf=''
				this.chargeMoney=0
				this.addText = false
				this.xiugai=false
				this.editshow=true
				this.leftphoto=false
				this.$refs.detail.style='block'
				this.selectedOptions2=[]
				this.employeeName=''
				this.employeeId=''
				this.formValidate.endDate=''
				this.formValidate.discount='1'
				this.formValidate.identityNo=''//证件号
				this.formValidate.userDef01=''
				this.formValidate.userDef02=''
				this.formValidate.userDef03=''
				this.formValidate.userDef04=''
				this.formValidate.userDef05=''
				this.formValidate.userDef06=''
				this.employeeName= this.user.name//默认当前登录者为导购名称
				this.employeeId = this.user.id//默认当前登录者为Id
				this.getCardList()
			},
			//点击修改
			edit(){
				this.$refs.detail.style.display='none'
				this.editshow=false
				this.xiugai=true
				this.leftphoto=true
				this.addoredit='修改会员'
				this.getCrmDetail(this.indexId)
			},
			//保存修改
			saveEdit(name){
				this.$refs[name].validate((valid) => {
					if(valid){
						this.axios.put('crm/update?uid='+this.uid,{
						id:this.indexId,
						code:this.code,
						level:this.formValidate.crmCardName,
						levelId:this.crmCardId,
						photo:this.photo,
						name:this.formValidate.name,//会员名
						mobile:this.formValidate.mobile,//手机号
						employeeId:this.employeeId,
						employeeName:this.employeeName,
						address:this.formValidate.address,//地址
						
						chargeMoney:this.chargeMoney,
						gender:this.gender,
						// discount:Number(this.formValidate.discount),
						birthday:this.birthday,
						endDate:this.formValidate.endDate,
						storeName:this.storeName,
						storeId:this.storeId,
						identityNo:this.formValidate.identityNo,//证件号
						userDef01:this.formValidate.userDef01,
						userDef02:this.formValidate.userDef02,
						userDef03:this.formValidate.userDef03,
						userDef04:this.formValidate.userDef04,
						userDef05:this.formValidate.userDef05,
						userDef06:this.formValidate.userDef06,
					}).then(res=>{
						if(res.data.status==200){

							this.$notify({
						        title:"",//
						        message: this.$t('public.editSuccess'),//
						        type: 'success',
						        position: 'bottom-right'
					        });
					        this.employeeName= this.user.name//默认当前登录者为导购名称
							this.employeeId = this.user.id//默认当前登录者为Id
							this.code=''
							this.formValidate.crmCardName=''
							this.crmCardId=''
							this.photo=''
							this.name=''//会员名
							this.formValidate.mobile='' //手机号
							this.email=''
							this.birthday=new Date(new Date().getFullYear()-18,0,0)
							this.formValidate.address=''//地址
							this.formValidate.province=''//省
							this.formValidate.city=''//市
							this.formValidate.district=''//区
							this.storeName=''
							this.employeeName=''
							this.employeeId=''
							this.storeId=''
							this.gender='男'
							this.formValidate.endDate=''
							this.qq=''
							this.formValidate.password=''
							this.dqjf=''
							this.chargeMoney=0
							this.addText = false
							this.xiugai=false
							this.editshow=true
							this.leftphoto=false
							this.$refs.detail.style='block'
							this.selectedOptions2=[]
							this.formValidate.identityNo=''//证件号
							this.formValidate.userDef01=''
							this.formValidate.userDef02=''
							this.formValidate.userDef03=''
							this.formValidate.userDef04=''
							this.formValidate.userDef05=''
							this.formValidate.userDef06=''
							this.getMentList(this.valueT)
							this.getcginfo(this.indexId,this.numIndex)
							this.getCardList()
						}
					})
					}
				})
			},
			//点击差号
			cancelHome(){
				this.$router.push('management')
			},
			//单击左侧列表
			getcginfo(id,index){
				this.numIndex = index
				this.indexId = id
				this.addText = false
				this.xiugai=false
				this.editshow=true
				this.leftphoto=false
				this.addoredit='会员详情'
				this.$refs.detail.style.display='block'
				this.getCrmDetail(id)
				this.getOrder()//会员订单
				this.getAllAddress(this.indexId)
			},
			//获取会员详情
			getCrmDetail(id){
				this.axios.get('crm/get/'+id+'?uid='+this.uid).then(res=>{
					if(res.data.status==200){
						console.log(res.data.rows)
						this.crmDetail=res.data.rows
						this.code=res.data.rows.code
						this.formValidate.crmCardName=res.data.rows.level
						this.crmCardId=res.data.rows.levelId
						this.photo=res.data.rows.photo
						this.formValidate.name=res.data.rows.name//会员名
						this.formValidate.mobile=res.data.rows.mobile //手机号
						if(res.data.rows.birthday=="" || res.data.rows.birthday==undefined){
							this.birthday=""
						}else{
							this.birthday=this.getLocalTime(res.data.rows.birthday)
							// this.birthday=new Date(res.data.rows.birthday).getFullYear()+'-'+(new Date(res.data.rows.birthday).getMonth()+1)+'-'+new Date(res.data.rows.birthday).getDate()
						}
						
						this.formValidate.address=res.data.rows.address//地址
						this.employeeName= res.data.rows.employeeName//导购
						this.employeeId = res.data.rows.employeeId//导购
						this.storeName=res.data.rows.storeName
						this.storeId=res.data.rows.storeId
						this.gender=res.data.rows.gender
						this.chargeMoney=res.data.rows.chargeMoney
						this.dqjf=res.data.rows.dqjf
						this.formValidate.endDate=res.data.rows.endDate
						this.formValidate.discount=String(res.data.rows.discount)

						this.formValidate.identityNo=String(res.data.rows.identityNo)//证件号
						this.formValidate.userDef01=String(res.data.rows.userDef01)
						this.formValidate.userDef02=String(res.data.rows.userDef02)
						this.formValidate.userDef03=String(res.data.rows.userDef03)
						this.formValidate.userDef04=String(res.data.rows.userDef04)
						this.formValidate.userDef05=String(res.data.rows.userDef05)
						this.formValidate.userDef06=String(res.data.rows.userDef06)

						this.crmDetail.createTime=new Date(this.crmDetail.createTime).toLocaleDateString().replace(/\//g,'-')
						if(this.crmDetail.status==1){//正常
							this.startisshow=false
							this.startisstop=true
			
						}
						if(this.crmDetail.status==9){//拉黑
							this.startisshow=true
							this.startisstop=false
						}
						if(this.crmDetail.status==0){
					
						}

					}
				})
			},
			 //下拉框选择
			orderselected(value){
				this.valueT = value
				this.getMentList(this.valueT)
			},
			//下拉加载更多
            handleReachEdge(){
				this.current++//默认10条
				if(this.valueT==0){
					this.axios.get('crm/query?offset='+this.current+'&uid='+this.uid).then((res)=>{
						if(this.current>Math.ceil(this.totalcl/this.pageSizecl)){
								this.current=Math.ceil(this.totalcl/this.pageSizecl)
							}
							res.data.rows.forEach((item)=>{
							this.Allcrm.push(item)
							this.Allcrm.forEach((x)=>{
								if(x.status==1){
								x.statusDesc=this.$t('public.normalS')
							}
							if(x.status==0){
								x.statusDesc=this.$t('public.addnew')
							}
							if( x.status==7){
								x.statusDesc=this.$t('public.normalT')
							}
									x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
								})

						})

					})
				}else{
					this.axios.get('crm/query?offset='+this.current+'&uid='+this.uid+'&status='+this.valueT).then((res)=>{
						if(this.current>Math.ceil(this.totalcl/this.pageSizecl)){
								this.current=Math.ceil(this.totalcl/this.pageSizecl)
							}
							res.data.rows.forEach((item)=>{
							this.Allcrm.push(item)
							this.Allcrm.forEach((x)=>{
								// if(x.status==1){
								// x.statusDesc=this.$t('public.normalS')
								// }
								// if(x.status==0){
								// 	x.statusDesc=this.$t('public.addnew')
								// }
								// if( x.status==7){
								// 	x.statusDesc=this.$t('public.normalT')
								// }
									x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
								})

						})

					})
				}


            },
            //选择生日
            changeBirthday(date){
            	this.birthday = this.getLocalTime(date)
            	console.log()
            },
            //选择性别
            selsectedSex(label){
            	this.gender = label
            	console.log(this.gender)
            },
            //取消确认
            cancelStore(){
            	this.crmCardisshow=false
            	this.storeisshow=false
            },
            //单击员工列表一行
			ckrow(data,index){
				this.eysureObj=data
				// this.employeeName= data.name
				// this.employeeId = data.id
			},
			ckrow1(data){
				this.employeeName=data.name
				this.employeeId = data.id
				this.storeisshow=false
				this.storeisshow1=false
			},
			//导购确认
			eysure(){
				this.employeeName=this.eysureObj.name
				this.employeeId = this.eysureObj.id
				this.storeisshow=false
			},
			//双击取人
			dblclickDGsrow(){
				this.eysure()
			},
			changeInput(){
				if(this.employeeName==''){
					this.allStore=[]
					this.storeisshow1=false
				}else{
					this.axios.get('employee/query?keyword='+this.employeeName+'&uid='+this.uid+'&status=1').then((res)=>{
	            		if(res.data.status==200){
	            			this.allStore = res.data.rows
	            			this.ygtotal=res.data.total
							this.ygpageSize=res.data.pageSize
							this.storeisshow1=true
							this.allStore.forEach((x)=>{
								if(x.gender==1){
									x.gender="男"
								}
								if(x.gender==0){
									x.gender="女"
								}
				               	x.createTime = this.getLocalTime(x.createTime)
				               	if(x.birthday==null){
				               		x.birthday=''
				               	}else{
				               		x.birthday = this.getLocalTime(x.birthday)
				               	}
			               })
	            		}
	            	})
				}
			},
            //获取会员
            selecteStore(){
            	this.storeisshow=true
            	this.axios.get('employee/query?uid='+this.uid+'&status=1').then((res)=>{
            		if(res.data.status==200){
            			this.allStore = res.data.rows
            			this.ygtotal=res.data.total
						this.ygpageSize=res.data.pageSize
						
						this.allStore.forEach((x)=>{
							if(x.gender==1){
								x.gender="男"
							}
							if(x.gender==0){
								x.gender="女"
							}
			               	x.createTime = this.getLocalTime(x.createTime)
			               	if(x.birthday==null){
			               		x.birthday=''
			               	}else{
			               		x.birthday = this.getLocalTime(x.birthday)
			               	}
		               })
            		}
            	})
            },
            
			//上传前
            beforeAvatarUpload(file) {
		        const isJPG = file.type === 'image/jpeg';
		        const isPng = file.type === 'image/png';
		        const isLt2M = file.size / 1024 / 1024 < 2;
		        if (!isJPG && !isPng) {
			          this.$notify({
				        title: "",//'失败',
				        message:this.$t('public.upJpngOrPng'),
				        type: 'error',
				        position: 'bottom-right'
			        });
		        }
		        if (!isLt2M) {
			         this.$notify({
				        title: "",//'失败',
				        message:this.$t('public.upJpngTwoM'),
				        type: 'error',
				        position: 'bottom-right'
			        });
		        }
		        return isJPG || isPng && isLt2M;
		      },
            //上传图片成功
            addsucess(res,file){
            	if(res.status==200){
            		this.photo=res.rows.url
            	}else{
            		this.$notify({
                        title: "",//'失败',
                        message:"上传失败",
                        type: 'error',
                        position: 'bottom-right'
                    });
            	}
                
            },
            //点击店铺
            clickStore(){
            	this.getStore()
            	this.storeNameisshow=true
            },
            //所有店铺列表
            getStore(){
            	this.axios.get('/store/query?uid='+this.uid).then((res)=>{
            		if(res.data.status==200){
            			this.storeData=res.data.rows
            			this.storetotal1=res.data.total
            			this.storepageSize1=res.data.pageSize
            			this.storeData.forEach(x=>{
            				x.Aaddress=x.province+x.district+x.city
            			})
            		}
            	})
            },
            //搜索店铺GET /store/query 店铺管理
            clicksearchstore(){
            	this.axios.get('/store/query?keyword='+this.storekeyword+'&uid='+this.uid).then((res)=>{
            		if(res.data.status==200){
            			this.storeData=res.data.rows
            			this.storetotal1=res.data.total
            			this.storepageSize1=res.data.pageSize
            			this.storeData.forEach(x=>{
            				x.Aaddress=x.province+x.district+x.city
            			})
            		}
            	})
            },
            //回车搜索
            storeEnter(){
            	this.clicksearchstore()
            },
            //店铺翻页
            storegetData(current){
            	this.axios.get('/store/query?offset='+current+'&uid='+this.uid).then((res)=>{
            		if(res.data.status==200){
            			this.storeData=res.data.rows
            			this.storetotal1=res.data.total
            			this.storepageSize1=res.data.pageSize
            			this.storeData.forEach(x=>{
            				x.Aaddress=x.province+x.district+x.city
            			})
            		}
            	})
            },
            storechangePageSize(size){
            	this.storepageSize1=size
            },
            //店铺点击一行
            crmrowstore(data,index){
            	this.storeObj=data
            	console.log(this.storeObj)
            },
            //回车确认店铺
            dblcrmrowstore(){
            	this.sureStorestore()
            },
            //店铺取消
            cancelStorestore(){
            	this.storeNameisshow=false
            },
            //店铺确认
            sureStorestore(){
            	this.storeName=this.storeObj.name
            	this.storeId=this.storeObj.id
            	this.storeNameisshow=false
            },
            del(){
            	this.$Modal.confirm({
                    title: '删除会员',
                    content: '<p>确定要删除吗?</p>',
                    onOk: () => {
                        this.axios.delete('crm/delete/'+this.indexId+'?uid='+this.uid).then((res)=>{
		            		if(res.data.status==200){
		            			this.$notify({
							       title:"",//
							        message: this.$t('public.deleteSuccess'),//
							        type: 'success',
							        position: 'bottom-right'
								});
								this.getcginfo(this.indexId,this.numIndex)
		            			this.getMentList(this.valueT)
		            			this.indexId=''
		            		}else{
		            			this.$notify({
							        title:"",//
							        message: res.data.errorMessage,
							        type: 'error',
							        position: 'bottom-right'
						        });
		            		}
		            	})
                    },
                });
            	
            },
             stop(){
            	if(this.indexId!=''){
             		this.axios.post('crm/disabled/'+this.indexId+'?uid='+this.uid).then((res)=>{
            		if(res.data.status==200){
            			this.$notify({
					        title:"",//
					        message:"已拉黑",// '停用成功',
					        type: 'success',
					        position: 'bottom-right'
						});
						this.getcginfo(this.indexId,this.numIndex)
            			this.getMentList(this.valueT)
            			this.indexId=''
            			this.numIndex=-1
            		}else{

            			this.$notify({
					        title:"",//
					        message:  res.data.errorMessage,
					        type: 'error',
					        position: 'bottom-right'
				        });
            		}
            	})
             	}else{
                 this.$notify({
                    title:"",//
                    message: this.$t('public.errorOneData'),
                    type: 'error',
                    position: 'bottom-right'
                  });
              }
            },
             start(){
             	if(this.indexId!=''){
             		this.axios.post('crm/enabled/'+this.indexId+'?uid='+this.uid).then((res)=>{
            		if(res.data.status==200){

            			this.$notify({
					        title:"",//
					        message: "已恢复",// '启用成功',
					        type: 'success',
					        position: 'bottom-right'
						});
						this.getcginfo(this.indexId,this.numIndex)
            			this.getMentList(this.valueT)
            			this.indexId=''
            			this.numIndex=-1
            		}else{
            			this.$notify({
					        title:"",//
					        message: res.data.errorMessage,
					        type: 'error',
					        position: 'bottom-right'
				        });
            		}
            	})
             	}else{
                 this.$notify({
                    title:"",//
                    message: this.$t('public.errorOneData'),
                    type: 'error',
                    position: 'bottom-right'
                  });
              }

            },
            //点击了订单
            getOrder(){
            	this.axios.get('crm/order/'+this.indexId+'?uid='+this.uid).then(res=>{
					if(res.data.status==200){
						this.orderdataList = res.data.rows
						this.total=res.data.total;
						this.pageSize = res.data.pageSize
						this.orderdataList.forEach(item=>{
							switch(item.status){
								case 1:
									item.statusDesc=this.$t('orders.newOrder')
								break;
								case 10:
									item.statusDesc=this.$t('orders.ySure')
								break;
								case 20:
									item.statusDesc=this.$t('orders.yPay')
								break;
								case 23:
									item.statusDesc=this.$t('orders.orderDfh')
								break;
								case 30:
									item.statusDesc=this.$t('orders.orderYFH')
								break;
								case 50:
									item.statusDesc=this.$t('orders.shSuccess')
								break;
								case 99:
									item.statusDesc=this.$t('orders.iscancel')
								break;
							}
							item.createTime=new Date(item.createTime).toLocaleDateString().replace(/\//g,'-')
						})
						console.log(res.data.rows)
					}
				})
            },
            //选择失效时间
            changeEndDate(d){
            	console.log(d)
            	this.endDate=d
            },
            //添加下边框
			addborder(index){
				this.num2 = index
				//index为1点击了订单orderdataList
				if(index==0){
					this.getOrder()
				}
				//点击积分
				if(index==1){
					this.axios.get('crm/integral/'+this.indexId+'?uid='+this.uid).then(res=>{
						if(res.data.status==200){
							this.jfdataList=res.data.rows
							this.jftotal = res.data.total
							this.jfpageSize =res.data.pageSize
						}
					})
				}
				//点击充值历史
				if(index==2){
					this.axios.get('crm/recharge/'+this.indexId+'?uid='+this.uid).then(res=>{
						if(res.data.status==200){
							this.czdataList=res.data.rows
							this.cztotal=res.data.total
							this.czpageSize=res.data.pageSize
							this.czdataList.forEach(x=>{
								x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
							})
						}

					})
				}
				//点击消费历史
				if(index==3){
					this.axios.get('crm/pay/'+this.indexId+'?uid='+this.uid).then(res=>{
						if(res.data.status==200){
							this.xfdataList=res.data.rows
							this.xftotal=res.data.total
							this.xfpageSize=res.data.pageSize
							this.xfdataList.forEach(x=>{
								x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
							})
						}

					})
				}
			},
			//消费翻页
			 //切换一条页
            xfgetData(current){
                this.axios.get('crm/pay/'+this.indexId+'?offset='+current+'&uid='+this.uid).then((res)=>{
                    //console.log(res)
                    this.xfdataList = res.data.rows
                   	this.xftotal=res.data.total
					this.xfpageSize=res.data.pageSize
                    this.xfdataList.forEach((x,index)=>{

							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
						})
                })
            },
            //翻页
            xfchangePageSize(size){
                this.xfpageSize = size
            },
			//充值翻页
			 //切换一条页
            czgetData(current){
                this.axios.get('crm/recharge/'+this.indexId+'?offset='+current+'&uid='+this.uid).then((res)=>{
                    //console.log(res)
                    this.czdataList = res.data.rows
                    this.cztotal=res.data.total
					this.czpageSize=res.data.pageSize
                    this.czdataList.forEach((x,index)=>{

							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
						})
                })
            },
            //翻页
            czchangePageSize(size){
                this.czpageSize = size
            },
			//订单翻页
			 //切换一条页
            getData(current){
                this.axios.get('crm/order/'+this.indexId+'?offset='+current+'&uid='+this.uid).then((res)=>{
                    //console.log(res)
                    this.orderdataList = res.data.rows
                    this.total=res.data.total;
					this.pageSize = res.data.pageSize
                    this.orderdataList.forEach((x,index)=>{

							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
						})
                })
            },
            //翻页
            changePageSize(size){
                this.pageSize = size
            },
            //积分翻页
             //切换一条页
            jfgetData(current){
                this.axios.get('crm/integral/'+this.indexId+'?offset='+current+'&uid='+this.uid+'&status='+this.valueT).then((res)=>{
                    //console.log(res)
                    this.jfdataList = res.data.rows
                    this.jftotal = res.data.total
					this.jfpageSize =res.data.pageSize
                    this.jfdataList.forEach((x,index)=>{

							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
						})
                })
            },
            //翻页
            jfchangePageSize(size){
                this.jfpageSize = size
            },
			//获取所有会员
	        getMentList(s){
	            this.axios.get('crm/query?uid='+this.uid+'&status='+s).then((res)=>{
	                if(res.data.status==200){
	                	this.Allcrm = res.data.rows
	                	this.totalcl=res.data.total
	                	this.pageSizecl=res.data.pageSize
						console.log(this.Allcrm)
						this.Allcrm.forEach((x)=>{
							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
							// if(x.status==1){
							// 	x.statusDesc=this.$t('public.normalS')
							// }
							// if(x.status==0){
							// 	x.statusDesc=this.$t('public.addnew')
							// }
							// if( x.status==7){
							// 	x.statusDesc=this.$t('public.normalT')
							// }
						})

	                }else{
	                	this.$notify({
					        title:"",//
					        message: res.data.errorMessage,
					        type: 'error',
					        position: 'bottom-right'
				        });
	                }
	            })
	        },
	        getygData(current){
	        	 this.axios.get('employee/query?offset='+current+'&uid='+this.uid+'&status=1').then((res)=>{
	        	 		this.allStore = res.data.rows
						this.ygtotal=res.data.total
						this.ygpageSize=res.data.pageSize

						this.allStore.forEach((x)=>{
							if(x.gender==1){
								x.gender="男"
							}
							if(x.gender==0){
								x.gender="女"
							}
			               	x.createTime = this.getLocalTime(x.createTime)
			               	if(x.birthday==null){
			               		x.birthday=''
			               	}else{
			               		x.birthday = this.getLocalTime(x.birthday)
			               	}
		               })
	        	 })
	        },
	        changeygPageSize(size){
	        	this.ygpageSize=size
	        },
	        //回车搜索
	        entersearchYG(){
	        	this.searchYG()
	        },
	        //搜索导购会员
	        searchYG(){
	        	this.axios.get('employee/query?keyword='+this.ygkeyword+'&uid='+this.uid+'&status=1').then((res)=>{
					if(res.data.status==200){
						this.allStore = res.data.rows
						this.ygtotal=res.data.total
						this.ygpageSize=res.data.pageSize

						this.allStore.forEach((x)=>{
							if(x.gender==1){
								x.gender="男"
							}
							if(x.gender==0){
								x.gender="女"
							}
			               	x.createTime = this.getLocalTime(x.createTime)
			               	if(x.birthday==null){
			               		x.birthday=''
			               	}else{
			               		x.birthday = this.getLocalTime(x.birthday)
			               	}
		               })
					}
				})
	        },
	        //回车搜索会员卡
	        cardEnter(){
	        	this.clicksearch()
	        },
	        //会员卡关键字搜索
	        clicksearch(){
	            this.axios.get('crmlevel/query?keyword='+this.cardKeyword+'&uid='+this.uid).then((res)=>{
					if(res.data.status==200){
						this.crmCardData = res.data.rows
						this.cardtotal=res.data.total
						this.cardpageSize=res.data.pageSize
					}
				})
	        },
	        //会员卡确认
	        sureStore(){
	        	this.formValidate.crmCardName= this.crmCardObj.name
				this.crmCardId = this.crmCardObj.id
				this.crmCardisshow=false
	        },
	         //回车确认会员卡
	        dblcrmrow(){
	        	this.sureStore()
	        },
	        //单击会员卡列表一行
			crmrow(data,index){
				this.crmCardObj=data
				console.log(data)
			},
	        //会员卡翻页
	        cardgetData(current){
	        	 this.axios.get('crmlevel/query?offset='+current+'&uid='+this.uid).then((res)=>{
                  	this.crmCardData = res.data.rows
					this.cardtotal=res.data.total
					this.cardpageSize=res.data.pageSize
                })
	        },
	        cardchangePageSize(size){
	        	this.cardpageSize=size
	        },
	        //搜索会员GET /crm/query 会员清单
	        search(){
	        	this.axios.get('/crm/query?keyword='+this.searchKeyword+'&uid='+this.uid).then(res=>{
	        		if(res.data.status==200){
	        			this.Allcrm = res.data.rows
	                	this.totalcl=res.data.total
						this.pageSizecl=res.data.pageSize
						this.Allcrm.forEach((x)=>{
							x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
							// if(x.status==1){
							// 	x.statusDesc=this.$t('public.normalS')
							// }
							// if(x.status==0){
							// 	x.statusDesc=this.$t('public.addnew')
							// }
							// if( x.status==7){
							// 	x.statusDesc=this.$t('public.normalT')
							// }
						})

	        		}
	        	})
	        },
	        enterSearch(){
	        	this.search()
			},
			//密码重置
			passwordRest(){
				this.passIsshow=true
			},
			//重置密码GET /crm/resps/{crmId} 重置密码
			surePss(name){
				this.$refs[name].validate((valid) => {
					if(valid){
						this.axios.get('/crm/resps/'+this.indexId+'?uid='+this.uid,{
							params:{
								password:this.loginformValidate.rpass
							}

						}).then(res=>{
							if(res.data.status==200){
								this.$notify({
									title:"",//
									message: this.$t('orders.passRestS'),
									type: 'success',
									position: 'bottom-right'
								});
								this.cancelPass()
							}else{
								this.$notify({
									title:"",//
									message: res.data.errorMessage,
									type: 'error',
									position: 'bottom-right'
								});
							}
						})
					}
				})

			},
			cancelPass(){
				this.loginformValidate.rpass=''
				this.loginformValidate.repeatpass=''
				this.passIsshow=false
			},
		},
		created(){
			this.$nextTick(()=>{
				this.getMentList(this.valueT)
			})
		},
		mounted(){
			this.employeeName= this.user.name//默认当前登录者为导购名称
			this.employeeId = this.user.id//默认当前登录者为Id
			this.getCardList();//默认会员卡
			if(this.$route.query.id){
				this.indexId = this.$route.query.id
				this.valueT = this.$route.query.s
				this.numIndex = this.$route.query.index
				this.getcginfo(this.indexId,this.numIndex)
			}
			this.height = document.documentElement.clientHeight
			window.onresize=function(){
				this.height = document.documentElement.clientHeight
			}
		}
	}
</script>
<style type="text/css" scoped>
.lanrenLeft{
	position: absolute;
    text-align: center;
    top: 0px;
    right: 0px;
    width: 0;
    height: 0;
    border-top:50px solid #d53c39;
    border-left:50px solid transparent;
}
.lanrenLeft span{
	width: 43px;
    height: 23px;
    color: #fff;
    display: block;
    position: relative;
    z-index: 9;
    top: -40px;
    right: 40px;
    font-size: 12px;
     font-weight: 100;
    transform: rotate(46deg);
}

.bg3{
 border-top: 50px solid #40ca98;
}
.bg4{
 border-top: 50px solid #3b77e3;
}
.addCrm{
	width:100%;
	height:100%
}
.head{
	width: 100%;
	height: 60px;
	border-bottom: 1px solid #e4e4e4;
	z-index: 10;
	background: #ffffff;
	display: flex;
	justify-content: space-between;
	position: fixed;
}
.tot{
    position:fixed;
    bottom:10px;
    left:15%;
    z-index:12;
}
.left-top{
	height: 60px;
	width:360px;
	flex:0 0 360px;
	line-height: 60px;
	position:fixed;
	z-index:9;
	display:flex;
	background: #fff;
	padding-right:10px;
	border-bottom:1px solid #eee;
	border-right:1px solid #eee;
	justify-content: space-between;
}
.right-top{
	width: 100%;
    line-height: 60px;
	display: flex;
	justify-content: space-between;
}
.colorGender1{
	color:#40ca98;
}
.colorGender0{
	color:#d53c39;
}
.wldw{
	margin-left:10px;
}
.left-img{
    margin-right: 10px;
width: 60px;
height: 60px;
border-radius: 50%;
overflow: hidden;
/* margin-bottom: -8px; */
display: block;

line-height: 80px;
text-align: center;
}
.top-left-btn{
background: #3B77E3;
margin-right: 10px;
color: #fff;
border: none;
width: 26px;
height: 26px;
border-radius: 26px;
display: inline-block;
position: relative;
top: 12px;
}
.top-left-btn1{
background: #FF7D16;
}
.top-left-btn:hover{
cursor:pointer;
}
.left-content {
	height:100%;
	flex:0 0 360px;
width:360px;

border-right:1px solid #E6E6E6;
position:fixed;
background:#F9F9F9;
}
.con-list {
	display:flex;
	align-items: center;
	width: 100%;
	word-wrap:break-word;

	border-bottom: solid 1px #E6E6E6;
	padding: 0px 25px;

	cursor: pointer;
	position:relative;
}
.con-list:hover{
	cursor:pointer;
}
.con-list .date{
	position:absolute;
	right:10px;
	top:60px;
}
.con-list .status{
	width:100px;

	text-align: center;
	position: absolute;
    right: 0px;
    top: 47px;
}
.con-list .list-title {
	color: #0d0d0d;
	font-size: 14px;
	margin-bottom: 10px;
	margin-top: 20px;
}
div.con-list:last-child{
	margin-bottom:320px
}
  .lanren {
    position: absolute;
    text-align: center;
    top: 0px;
    right: 0px;
    width: 0;
    height: 0;
    border-top: 80px solid #d53c39;
    border-left: 80px solid transparent;
}
.lanren span{
    width: 60px;
    height: 60px;
    color: #fff;
    display: block;
    position: relative;

    top: -70px;
    right: 70px;
    font-size: 16px;
    font-weight: 900;
    transform: rotate(46deg);
}
.bgd1{
	  border-top: 80px solid #40ca98;
}
.bgd4{
	  border-top: 80px solid #d53c39;
}
.bgd3{
	  border-top: 80px solid #3b77e3;
}
.con-list .txt {
	color: #585858;
	font-size: 12px;
}
.bg{
	background:#dbe5f1
}

.add-right {
	margin-left:370px;
    height: 100%;
    position: relative;
    background: #fff;
    overflow: hidden;
    width: 100%;
    display: flex;
}
.list-box{
	display: flex;
	height:35px;
	line-height: 35px;
	margin:25px 10px;
}
.list-box1{
		margin:4px 10px;
}
.list-box span{
	height:40px;
	width:120px;
	text-align: center;
	padding:0 10px;

}
.list-box input.ivu-input{
	height:40px!important;
}
.list-box1{
	margin-left:20px;
}
.list-box1 span{
	width:auto;
	text-align: left
}
.right-left{
	width: 230px;
    margin-top: 26px;
	border: 1px dashed #d9d9d9;
	height:180px;
	text-align: center;
}

.right-right{
	width:100%;
	height:100%;
	margin-top:10px;
	margin-right:10px
}
.avatar-uploader .el-upload {
    border: 1px dashed #d9d9d9;
    border-radius: 6px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }
  .avatar-uploader .el-upload:hover {
    border-color: #409EFF;
  }
  .avatar-uploader-icon {
    font-size: 28px;
    color: #8c939d;
    width: 178px;
    height: 178px;
    line-height: 178px;
    text-align: center;
  }
  .avatar {
    width: 178px;
    height: 178px;
    display: block;
  }
   .title{
    	display:flex;justify-content: space-between;
    }
    .title:hover{
    	cursor:pointer;
    }
	.right-content{
		width: 100%;
		height:100%;
		/*	margin-bottom:100px;*/
	}
     .detail-top{
        margin-top:10px;
    }
.detail-top ul.cgtable1{
        margin-bottom: 20px
    }
    .detail-top ul li{
        display:inline-block;
        width:150px;
        /*border:1px solid red;*/
        margin:5px 10px;
    }
    .detail-top ul.cgtable li{
        color:#2B8F8F;
        margin:0px 10px;
        font-weight:600;
    }
	.detail-bottom{
		margin-bottom: 120px
	}
	.detail-title-mark{
		display:flex;
		justify-content: flex-start;
		border-bottom:1px solid #eee;
		margin-top:1px;
		margin-left: 10px;
	}
	.detail-title{
		padding:10px 40px;

	}
	.table{
		margin: 0 20px 0 0;
	}
	.page-box{
		margin-top:4px;
		text-align: left;
	}
	.detail-public{
		width:100%;
		margin:10px;
	}
	.bor{
		border-bottom:2px solid #086CA2;
	}
	 .addRess{
      width:94%;
      height:100%;
     height:300px;

      border:1px solid #f5f5f5;
    }
    .addRess-top{
      width:100%;
      height:50px;
      line-height: 50px;
      display: flex;
      justify-content: space-between;
      background: #F1F1F1
    }
     .addRess-top .addressTitle{
      font-weight:600;
      font-size:14px;
     }
     .addRess-top1{
      width:100%;
      height:40px;

      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom:1px solid #f1f1f1;
    }
     .addRess-top1:last-child{
        margin-bottom:400px;

     }
     .addressbtn0{
      width:10%;
      text-align: center;
     border-left:1px solid #f1f1f1;
     }
    .addressbtn{
      width:10%;
      text-align: center;


     border-left:1px solid #f1f1f1;
    }
    .address-left{
      padding:0 10px;
      width:10%;
      text-align: center;
      border-right:1px solid #f1f1f1;

    }
	.addressDetail{
		display: inline-block;

		height: 34px;
		margin-left:28px;
		text-indent: 10px;
		color: #555;
		background-color: #fff;
		background-image: none;
		border: 1px solid #eee;

		-webkit-box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
		box-shadow: inset 0 1px 1px rgba(0, 0, 0, .075);
		-webkit-transition: border-color ease-in-out .15s, -webkit-box-shadow ease-in-out .15s;
		-o-transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
		transition: border-color ease-in-out .15s, box-shadow ease-in-out .15s;
	}


	.title-ht span{
    width:20%;
    text-align: center
  }
</style>
<style type="text/css">
 .demo-spin-icon-load{
        animation: ani-demo-spin 1s linear infinite;
    }
 @keyframes ani-demo-spin {
    from { transform: rotate(0deg);}
    50%  { transform: rotate(180deg);}
    to   { transform: rotate(360deg);}
}
/*.el-upload--text{
	width:100%!important;
}*/
.el-notification{
		bottom:50px!important;
		top:82%!important;
	}
</style>
