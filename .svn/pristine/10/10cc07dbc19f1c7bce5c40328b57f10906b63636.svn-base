<template>
	<!--新建客户-->
	<div class="add-box">

			<!--固定导航-->
      <div class="heade">
           
                    <div class="left-top">
                      <p class="wldw">
                            <span style="width:42px;font-weight:900">筛选：</span>
                             <Select style="width:100px" v-model="valueT" placeholder="全部" @on-change="orderselected">
                                <Option v-for="item in orderListname" :value="item.value" :key="item.value">{{ item.label }}</Option>
                            </Select>
                        </p>
            						<div>
            						<!--新建-->
            						<span class="top-left-btn"  @click="addUnit">
            							<Icon type="plus" style="position:absolute;top:7px;left:8px"></Icon></span>
            					</div>
                    </div>
                    <div class="right-top">
                        <span style="margin-left:10px;font-size: 19px;font-weight: 600;position: absolute;left: 370px;">{{unitsText}}</span>
                        <div style="display:flex;margin-right: 10px;position: absolute;right: 70px;">
                        <div style='position:relative' v-show="addText">
                               
                              <div>
                                <Button type="primary" shape="circle" style="margin-right:5px;border:none;background:#3b77e3;color:#fff"
                                 @click='saveBaseInfo("f")' v-show="addText"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>保存</Button>
                                 <Button type="primary" shape="circle" style="background:#999999;color:#fff;margin-right:10px;"   @click="cancel" v-show="addText" ><Icon type="close" style="margin-right:5px;"></Icon>取消</Button>
                               
                               </div>
                            </div>
                             <div v-show="!addText">
                              <div style='position:relative'>
                               
                               </div>
                               <Button type="primary" shape="circle" style="background:#3b77e3;margin-right:5px;color:#fff;border:none"  @click="glsku" v-show="xiugaibtn1"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>关联商品</Button>
                              <!--  <Button type="primary" shape="circle" style="background:#3b77e3;margin-right:5px;color:#fff;border:none"  @click="loginSetting" v-show="xiugaibtn1"><Icon type="person" style=";margin-right:5px;color:#fff"></Icon>账号管理</Button> -->
                               <Button type="primary" shape="circle" style="background:#40ca98;margin-right:5px;color:#fff;border:none"  @click="changeUnitInfo1" v-show="xiugaibtn1"><i class="el-icon-edit" style=";margin-right:5px;"></i>修改</Button>
                                 <Button type="primary" shape="circle" style="background:#3b77e3;margin-right:5px;color:#fff;border:none"  @click="changeUnitInfo2('f1')" v-show="xiugaibtn2"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>保存</Button>
                                 <Button type="primary" shape="circle" style="background:#999999;color:#fff;margin-right:10px;"   @click="cancel" v-show="cancelxiu" ><Icon type="close" style="margin-right:5px;"></Icon>取消</Button>
                            </div>
              						<div style="margin-right:60px;display:flex">
                            <div v-show="newBusiness" class="cursor">
                              <Dropdown trigger="click"  v-if='!xiugaibtn2'>
                                  <Button shape="circle" type="ghost" style="background:#ff7d16;color:#fff;border:none">更多
                                  <span><i class="ivu-icon ivu-icon-chevron-down"></i></span>
                              </Button>
                              <DropdownMenu slot="list">
                                  <span @click="start" v-if='isstart'><DropdownItem >启用</DropdownItem></span>
                                  <span @click="stopUnits" v-if='isstop'><DropdownItem >停用</DropdownItem></span>
                                 
                                  <span @click="Invitation"><DropdownItem >邀请</DropdownItem></span>
                                  <span @click="delunit"><DropdownItem >删除</DropdownItem></span>
                                   <span @click='bjd'><DropdownItem >制作报价单</DropdownItem></span>
                              </DropdownMenu>
                              </Dropdown>
              								<span @click="cancelHome" style="cursor:pointer;margin-left: 10px;">
                                <Icon type="close" class="cha" ></Icon>
                              </span>
              							</div>
                           </div>
                        </div>
                    </div>
            
     </div>
		<div style='height:60px;width:100%'></div>
			<!--左边往来单位列表-->
				<div class="left-content">
            <div class='locationSearch'>
              <Input style='padding:10px 20px;' v-model='searchKeyword' :placeholder="$t('public.codeornameorphone')" @on-enter='enterSearch'>
              <span slot="append"  @click='search' style='cursor:pointer;'>搜索</span>
              </Input>
               <!-- <a style='font-size:14px;font-weight:600;margin-left:20px;border-bottom:1px solid #3b77e3;height:35px;line-hegiht:35px;line-height: 35px;margin-top: -2px;' @click='searchLocation()'>精准搜索</a> -->
            </div>
					<p v-if="Allunits.length==0" class='scrollFix'>
					      <Spin>
		                <div>{{loading}}</div>
		            </Spin>
				    </p>
					<Scroll :on-reach-bottom="handleReachEdge" :height="height" v-else >
						<div class="con-list" v-for="(item,index) in Allunits" :key='index' @click="updataUnit(item.id,index)" :class="{bg:numLeftList==index}">
               <span style="margin-right: 10px;">
                 <Checkbox :value="numLeftList==index"></Checkbox>
               </span>
               <div>
              <p class="list-title">
                <span>{{item.code}}</span>
                <span class='file' >
                  <Tooltip content="有附件" placement="right-start">
                          <img src="http://img.zsydian.com/gys_file.png" width='10' height='10' v-if='item.attachs' >
                      </Tooltip>
                </span>
              </p>
              <p class="txt" style="margin-top:10px;">{{item.name}}</p>

              <span class="status">{{item.level}} {{item.createTime}}</span>

              <span class="date">{{item.contract}}</span>
              </div>
              <div class="lanrenLeft" :class="{bgd4:item.statusDesc=='正常',bgd5:item.statusDesc=='新增',bgd6:item.statusDesc=='已停用'}">
                             <span >{{item.statusDesc}}</span>
                          </div>​
            </div>

					</Scroll>
				</div>
				<!--保存-->
				<div class="add-right">
					<div class="right-content"  v-show="addText">
						<div style="width:100%;height:100%;padding:10px 10px 0 10px;margin-bottom:100px">

						<Form ref="f" :model="formValidate"  :rules="ruleValidate" :label-width="80">

              <el-collapse v-model="activeName" :accordion="true">
                  <el-collapse-item title="客户信息" name="1">
                      <Row>
                      <Row>
                        <Col span="8">
                          <FormItem label="名称" prop="name">
                            <Input v-model="formValidate.name" placeholder="客户名称"></Input>
                           </FormItem>
                        </Col>
                        <Col span="8">
                         <FormItem label="编码" prop="code">
                                  <Input v-model="formValidate.code"   placeholder="编码/不填将自动生成"></Input>
                         </FormItem>
                        </Col>
                         <Col span="8">
                        <FormItem label="等级" prop="credits">
                            <Select  v-model='level'  placeholder="全部" @on-change="changekhlevel">
                              <Option v-for="item in khlevel" :value="item.value" :key="item.value">{{ item.label }}</Option>
                              </Select>
                         </FormItem>
                          </Col>
                        </Row>
                         <Row>
                          <Col span="8">
                           <FormItem label="类型" prop="classify">
                              <Select  v-model='classify' placeholder="全部" @on-change="changekhclassify">
                                <Option v-for="item in khclassify" :value="item.value" :key="item.value">{{ item.label }}</Option>
                                </Select>
                           </FormItem>
                          </Col>
                            <Col span="16">
                                <FormItem label="所属区域" >
                                   <div class="input-box">
                                      <el-cascader
                                        filterable
                                        expand-trigger="click"
                                        :options="cityInfo"
                                        v-model="selectedOptions2"
                                        @change="handleChange" style='width:300px'>
                                      </el-cascader>
                                      <Input type="text" v-model="address" placeholder="请输入详细地址" style="width:100%;margin-left:10px"></Input>
                                  </div>
                                 </FormItem>
                           </Col>
                          </Row>
                          <Row>
                         <Col span="8">
                           <FormItem label="联系人" prop="contract">
                                <Input v-model="formValidate.contract" placeholder="联系人"></Input>
                          </FormItem>
                          </Col>
                          <Col span="8">
                             <FormItem label="手机" prop="contractPhone">
                                <Input v-model="formValidate.contractPhone" placeholder="联系人手机"></Input>
                             </FormItem>
                           </Col>
                       </Row>
                     </Row>
                  </el-collapse-item>
              </el-collapse>
              <el-collapse >
                  <el-collapse-item title="开票信息" name="2">  
                    <Row>
                      <Col span="8">
                      <FormItem label="发票抬头" prop="invoiceTitle">
                            <Input v-model="formValidate.invoiceTitle"  placeholder="请填写您营业执照商的全称"></Input>
                        </FormItem>
                         </Col>
                         <Col span="8">
                        <FormItem label="税务号" prop="swdjh">
                          <Input v-model="formValidate.swdjh" placeholder="税务登记号"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="开户行" prop="khh">
                          <Input v-model="formValidate.khh" placeholder="请您填写开户许可证上的开户银行"></Input>
                       </FormItem>
                        </Col>
                      <Col span="8">
                       <FormItem label="注册地址" prop="regAddress">
                          <Input v-model="formValidate.regAddress" placeholder="请您填写营业执照上的注册地址"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="注册电话" prop="regTel">
                          <Input v-model="formValidate.regTel" placeholder="请您填写您公司有效的联系电话"></Input>
                       </FormItem>
                     </Col>
                    </Row>      
                  </el-collapse-item>        
							</el-collapse>	
               <el-collapse >  
                   <el-collapse-item title="联系人信息" name="3" >
                    <Row>
                      
                         <Col span="8">
                         <FormItem label="电话" prop="contractTel">
                            <Input v-model="formValidate.contractTel" placeholder="联系人电话"></Input>
                         </FormItem>
                       </Col>
                  </Row>
                  <Row>
                      <Col span="8">
                         <FormItem label="职位" prop="contractPosition">
                              <Input v-model="formValidate.contractPosition" placeholder="联系人职位"></Input>
                        </FormItem>
                      </Col>
                      <Col span="8">
                         <FormItem label="传真" prop="contractFax">
                            <Input v-model="formValidate.contractFax" placeholder="联系人传真"></Input>
                         </FormItem>
                       </Col>
                         
                         <Col span="8">
                         <FormItem label="邮箱" prop="contractEmail">
                            <Input v-model="formValidate.contractEmail" placeholder="联系人邮箱"></Input>
                         </FormItem>
                       </Col>
                       <Col span="24">
                       <FormItem label="地址" prop="contractAddress">
                              <Input v-model="formValidate.contractAddress" placeholder="联系人地址"></Input>
                          </FormItem>
                        </Col>
                  </Row>
                  <div style='width:100%;'>
                     <FormItem label="备注" prop="contractEmail">
                            <Input v-model="remark"  type="textarea" placeholder="备注信息 :" class="getaddress" :min-row="6"></Input>
                      </FormItem>
                   </div>
                   </el-collapse-item>   
               </el-collapse> 
								</Form>
                <el-collapse > 
                  <el-collapse-item title="多附件列表" name="3" >
                    <div >
                        <el-upload
                          class="upload-demo"
                          :action="actionUrl"
                          :on-success='success'
                          :before-upload="beforeAvatarUpload"
                           :on-progress='upProgress'
                          multiple
                          :show-file-list='false'
                          >
                          <Button shape="circle" type="primary" style="background:#3b77e3;border:none:color:#fff"> <span style='color:#fff'>上传附件</span></Button>
                        </el-upload>
                        </div>
                    <div  v-if='soe'>
                          <Spin>
                            <Icon type="load-c" size=18 class="demo-spin-icon-load"></Icon>
                            <div>文件正在上传....</div>
                        </Spin>
                      </div>
                      <div style='margin-left:10px'>
                          <div class='upDataList'>
                          <li v-for='(item,index) in upData' @mouseover='chaOver(item,index)' @mouseleave='chleave(item,index)'>
                          <img :src="item.url" width='80' height='80'>
                          <span>{{item.fileName}}</span>
                          <span v-if='chaIndex==index' @click='delUp(item,index)' ><Icon type="close" class="upcha" ></Icon></span>
                        </li>
                      </div>
                    </div>
                  </el-collapse-item >
                </el-collapse > 
						</div>
					</div>
				<!--客户修改-->
				<div class="right-content"  v-show="xiugai">
						<div  style="width:100%;100%;padding:10px 10px 0px 10px;margin-bottom:100px">
							<Form ref="f1" :model="formValidate"  :rules="ruleValidate" :label-width="80">
                <el-collapse v-model="activeName" :accordion="true">
                  <el-collapse-item title="客户信息" name="1">
                      <Row>
                        <Row>
                          <Col span="8">
                            <FormItem label="名称" prop="name">
                              <Input v-model="formValidate.name" placeholder="客户名称"></Input>
                             </FormItem>
                          </Col>
                          <Col span="8">
                           <FormItem label="编码" prop="code">
                                <Input disabled v-model="formValidate.code"   placeholder="编码/不填将自动生成"></Input>
                           </FormItem>
                          </Col>
                           <Col span="8">
                          <FormItem label="等级" prop="credits">
                              <Select  v-model='level'  placeholder="全部" @on-change="changekhlevel">
                                <Option v-for="item in khlevel" :value="item.value" :key="item.value">{{ item.label }}</Option>
                                </Select>
                           </FormItem>
                            </Col>
                          </Row>
                          <Row>
                          
                          <Col span="8">
                         <FormItem label="类型" prop="classify">
                            <Select  v-model='classify' placeholder="全部" @on-change="changekhclassify">
                              <Option v-for="item in khclassify" :value="item.value" :key="item.value">{{ item.label }}</Option>
                              </Select>
                         </FormItem>
                          </Col>
                          <Col span="16">
                        <FormItem label="所属区域" >
                           <div class="input-box">
                              <el-cascader
                                filterable
                                expand-trigger="click"
                                :options="cityInfo"
                                v-model="selectedOptions2"
                                @change="handleChange" style="width:300px">
                              </el-cascader>
                              <Input type="text" v-model="address" placeholder="请输入详细地址" style="width:100%;margin-left:10px"></Input>
                          </div>
                         </FormItem>
                         </Col>
                         </Row>
                         <Row>
                         <Col span="8">
                             <FormItem label="联系人" prop="contract">
                                  <Input v-model="formValidate.contract" placeholder="联系人"></Input>
                            </FormItem>
                          </Col>
                          <Col span="8">
                             <FormItem label="手机" prop="contractPhone">
                                <Input v-model="formValidate.contractPhone" placeholder="联系人手机"></Input>
                             </FormItem>
                           </Col>
                       </Row>
                     </Row>
                  </el-collapse-item >
                </el-collapse >
                <el-collapse >
                  <el-collapse-item title="开票信息" name="2">
                      <Row>
                      <Col span="8">
                      <FormItem label="发票抬头" prop="invoiceTitle">
                            <Input v-model="formValidate.invoiceTitle"  placeholder="请填写您营业执照商的全称"></Input>
                        </FormItem>
                         </Col>
                         <Col span="8">
                        <FormItem label="税务号" prop="swdjh">
                          <Input v-model="formValidate.swdjh" placeholder="税务登记号"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="开户行" prop="khh">
                          <Input v-model="formValidate.khh" placeholder="请您填写开户许可证上的开户银行"></Input>
                       </FormItem>
                        </Col>
                      <Col span="8">
                       <FormItem label="注册地址" prop="regAddress">
                          <Input v-model="formValidate.regAddress" placeholder="请您填写营业执照上的注册地址"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="注册电话" prop="regTel">
                          <Input v-model="formValidate.regTel" placeholder="请您填写您公司有效的联系电话"></Input>
                       </FormItem>
                     </Col>
                    </Row>
                  </el-collapse-item >
                </el-collapse >
                <el-collapse >
                  <el-collapse-item title="联系人信息" name="3">
                <Row>
                  <Col span="8">
                     <FormItem label="电话" prop="contractTel">
                        <Input v-model="formValidate.contractTel" placeholder="联系人电话"></Input>
                     </FormItem>
                  </Col>
                  </Row>
                  <Row>
                      <Col span="8">
                         <FormItem label="职位" prop="contractPosition">
                              <Input v-model="formValidate.contractPosition" placeholder="联系人职位"></Input>
                        </FormItem>
                      </Col>
                      <Col span="8">
                         <FormItem label="传真" prop="contractFax">
                            <Input v-model="formValidate.contractFax" placeholder="联系人传真"></Input>
                         </FormItem>
                       </Col>
                         
                         <Col span="8">
                         <FormItem label="邮箱" prop="contractEmail">
                            <Input v-model="formValidate.contractEmail" placeholder="联系人邮箱"></Input>
                         </FormItem>
                       </Col>
                       <Col span="24">
                       <FormItem label="地址" prop="contractAddress">
                              <Input v-model="formValidate.contractAddress" placeholder="联系人地址"></Input>
                          </FormItem>
                        </Col>
                  </Row>
                    <div style='width:100%;'>
                     <FormItem label="备注" prop="contractEmail">
                            <Input v-model="remark"  type="textarea" placeholder="备注信息 :" class="getaddress" :min-row="6"></Input>
                      </FormItem>
                   </div>
                  </el-collapse-item >
                </el-collapse >
                </Form>
                <el-collapse >
                 <el-collapse-item title="多附件列表" name="4">
                  <div >
                      <el-upload
                        class="upload-demo"
                        :action="actionUrl"
                        :on-success='success'
                        :before-upload="beforeAvatarUpload"
                         :on-progress='upProgress'
                        multiple
                        :show-file-list='false'
                        >
                        <Button shape="circle" type="primary" style="background:#3b77e3;border:none:color:#fff"> <span style='color:#fff'>上传附件</span></Button>
                      </el-upload>
                    </div>
                    <div  v-if='soe'>
                              <Spin>
                                <Icon type="load-c" size=18 class="demo-spin-icon-load"></Icon>
                                <div>文件正在上传....</div>
                            </Spin>
                          </div>
                    <div style='margin-left:10px'>
                      <div class='upDataList'>
                            <li v-for='(item,index) in upData' @mouseover='chaOver(item,index)' @mouseleave='chleave(item,index)'>
                              <img :src="item.url" width='80' height='80'>
                              <span>{{item.fileName}}</span>
                              <span v-if='chaIndex==index' @click='delUp(item,index)' ><Icon type="close" class="upcha" ></Icon></span>
                            </li>
                          </div>
                        </div>
                      </el-collapse-item >
                </el-collapse >
                    
						</div>

					</div>
				<!--详情明细订单页面-->
                    <div class="right-content right-detail" v-if="detailsInfo"  style="padding:10px 10px 0 10">
                     <Form  :label-width="80">
                      <Row>
                      <Row>
                      
                        <Col span="8">
                          <FormItem label="名称" prop="name">
                            <Input disabled v-model="formValidate.name" placeholder="客户名称"></Input>
                           </FormItem>
                        </Col>
                        <Col span="8">
                         <FormItem label="编码" prop="code">
                                  <Input disabled v-model="formValidate.code"   placeholder="编码/不填将自动生成"></Input>
                         </FormItem>
                        </Col>
                         <Col span="8">
                        <FormItem label="等级" prop="credits">
                            <Select  v-model='level'  placeholder="全部" disabled>
                              <Option v-for="item in khlevel" :value="item.value" :key="item.value">{{ item.label }}</Option>
                              </Select>
                         </FormItem>
                          </Col>
                          </Row>
                          <Row>
                          
                          <Col span="8">
                         <FormItem label="类型" prop="classify">
                            <Select  v-model='classify' placeholder="全部" disabled>
                              <Option v-for="item in khclassify" :value="item.value" :key="item.value">{{ item.label }}</Option>
                              </Select>
                         </FormItem>
                          </Col>
                          <Col span="16">
                        <FormItem label="所属区域" >
                           <div class="input-box">
                              <el-cascader
                                filterable
                                expand-trigger="click"
                                :options="cityInfo"
                                v-model="selectedOptions2"
                                disabled style="width:300px">
                              </el-cascader>
                              <Input disabled type="text" v-model="address" placeholder="请输入详细地址" style="width:100%;margin-left:10px"></Input>
                          </div>
                         </FormItem>
                         </Col>
                         </Row>
                         <Row>
                            <Col span="8">
                               <FormItem label="联系人" prop="contract">
                                    <Input disabled  v-model="formValidate.contract" placeholder="联系人"></Input>
                              </FormItem>
                            </Col>
                            <Col span="8">
                               <FormItem label="手机" prop="contractPhone">
                                  <Input disabled v-model="formValidate.contractPhone" placeholder="联系人手机"></Input>
                               </FormItem>
                             </Col>
                               <Col span="8">
                               <FormItem label="电话" prop="contractTel">
                                  <Input disabled v-model="formValidate.contractTel" placeholder="联系人电话"></Input>
                               </FormItem>
                             </Col>
                        </Row>
                     </Row>
                
                  <Row>
                      <Col span="8">
                      <FormItem label="发票抬头" prop="invoiceTitle">
                            <Input disabled v-model="formValidate.invoiceTitle"  placeholder="请填写您营业执照商的全称"></Input>
                        </FormItem>
                         </Col>
                         <Col span="8">
                        <FormItem label="税务号" prop="swdjh">
                          <Input disabled v-model="formValidate.swdjh" placeholder="税务登记号"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="开户行" prop="khh">
                          <Input disabled v-model="formValidate.khh" placeholder="请您填写开户许可证上的开户银行"></Input>
                       </FormItem>
                        </Col>
                      <Col span="8">
                       <FormItem label="注册地址" prop="regAddress">
                          <Input disabled v-model="formValidate.regAddress" placeholder="请您填写营业执照上的注册地址"></Input>
                       </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="注册电话" prop="regTel">
                          <Input disabled v-model="formValidate.regTel" placeholder="请您填写您公司有效的联系电话"></Input>
                       </FormItem>
                     </Col>
                    </Row>
                  <Row>
                      <Col span="8">
                        <FormItem label="职位" prop="contractPosition">
                            <Input disabled v-model="formValidate.contractPosition" placeholder="联系人职位"></Input>
                         </FormItem>
                       </Col>
                       <Col span="8">
                         <FormItem label="传真" prop="contractFax">
                            <Input disabled v-model="formValidate.contractFax" placeholder="联系人传真"></Input>
                         </FormItem>
                       </Col>
                       <Col span="8">
                       <FormItem label="邮箱" prop="contractEmail">
                          <Input disabled v-model="formValidate.contractEmail" placeholder="联系人邮箱"></Input>
                       </FormItem>
                        </Col>
                        <FormItem label="地址" prop="contractAddress">
                          <Input disabled v-model="formValidate.contractAddress" placeholder="联系人地址"></Input>
                      </FormItem>
                   </Row>
                  
                    <div style='width:100%;'>
                     <FormItem label="备注" prop="contractEmail">
                            <Input disabled v-model="remark"  type="textarea" placeholder="备注信息 :" class="getaddress" :min-row="6"></Input>
                      </FormItem>
                   </div>
                </Form>
                           <!--客户详情页面cgxqInfo-->
                            <div class="detail-title-mark" style='margin-top:20px'>
                                <div v-for="(item,index) in titles1" class="detail-title" @click="addborder1(index)" :class="{bor:index==num4}">
                                    {{item}}
                                </div>
                            </div>
                            <!--关注商品-->
                            <div v-if='num4==0' style="margin-bottom: 120px;">
                            	<div style='margin: 10px;'>
	                            	<Table size="small" border  height="300"  :columns="goodskey1" :data="selectedgoodsrow1" >
              									</Table>
                                <div style='margin-top:10px'>
              									<Page v-if='goodskey1total!=0' :total="goodskey1total" show-total size="small" :pageSize='goodskey1pageSize'  @on-change="goodskey1getData" @on-page-size-change="goodskey1changePageSize"></Page>
                                </div>
              								</div>
                            </div>
                            <!--报价单历史-->
                             <div v-if='num4==1' style="margin-bottom: 120px;">
                             	<div style='margin: 10px;'>
	                            	<Table size="small" border  height="300"  :columns="goodskey2" :data="selectedgoodsrow2" >
              									</Table>
                                 <div style='margin-top:10px'>
              									   <Page v-if='goodskey2total!=0' :total="goodskey2total" show-total size="small" :pageSize='goodskey2pageSize'  @on-change="goodskey2getData" @on-page-size-change="goodskey2changePageSize"></Page>
                                  </div>
              								</div>
                            </div>
                            <!--客户地址管理-->
                            <div v-if='num4==2' style="margin-bottom: 120px;">
                               <div class='addRess' style='margin: 10px;'>
                                <!--头部-->
                                  <div class='addRess-top'>
                                    <div  class='address-left'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div>
                                    <div class='addressTitle'>地址设置</div>
                                    <div style='color:#4E7DDD;cursor:pointer' class='addressbtn0' @click='addr'>新增地址</div>
                                  </div>
                                  <div class='addRess-top1'>
                                    <div class='address-left'>默认地址</div>
                                    <div class='title-ht' style='display: flex;width:100%;font-weight:600'>
                                      <span>所在地区</span>
                                      <span >详细地址</span>
                                      <span>联系人</span>
                                      <span>联系手机</span>
                                      <span>联系电话</span>
                                    </div>
                                    <div style='color:#4E7DDD;' class='addressbtn'>操作栏</div>
                                  </div>
                                  <!--地址列表-->
                                  <div class='addRess-top1' v-for='(i,index) in AllAddress'>
                                    <div class='address-left'>
                                       <Checkbox :value="i.default" @on-change='defaultAddress(i.id)'></Checkbox>
                                    </div>
                                    <div class='addressTitle title-ht' style='display:flex;;align-items: center;width: 100%;'>

                                      <span>{{i.province}}  {{i.city}} {{i.country}}</span>

                                      <span style='word-wrap: break-word;'>{{i.address}}</span>
                                      <span>{{i.name}}</span>

                                      <span>{{i.mobile}}</span>
                                      <span >{{i.phone}}</span>
                                    </div>
                                    <div style='color:#72C89E;cursor:pointer' class='addressbtn' >

                                      <span @click='editAddressBtn(i.id)'>修改</span>
                                      <span @click='deleteAddressBtn(i.id)' style='color:#d53c39'>删除</span>

                                    </div>
                                  </div>
                               </div>
                            </div>
                            <!--附件-->
                            <div v-if='num4==3' style="margin-bottom: 120px;">
                              <div style='margin: 10px;'>
                                <div>
                                    <div  v-if='soe'>
                                          <Spin>
                                            <Icon type="load-c" size=18 class="demo-spin-icon-load"></Icon>
                                            <div>文件正在上传....</div>
                                        </Spin>
                                        </div>
                                        <div v-if='upData1==null'>
                                          <span>暂无附件</span>
                                        </div>
                                  <div class='upDataList' v-else>
                                        <li v-for='(item,index) in upData1'>
                                          <img :src="item.url" width='80' height='80'>
                                          <span>{{item.fileName}}</span>
                                          <span v-if='chaIndex==index' ><Icon type="close" class="upcha" ></Icon></span>
                                        </li>
                                  </div>
                              </div>
                              </div>
                            </div>
                            <!--报价商品-->
                            <div v-if='num4==4' style="margin-bottom: 120px;">
                              <div style='margin: 10px;'>
                                <div>
                                  <Table size="small" border  height="300"  :columns="goodskey3" :data="selectedgoodsrow3" >
                                </Table>
                                <div style='margin-top:10px'>
                                <Page v-if='goodskey3total!=0' :total="goodskey3total" show-total size='small' :pageSize='goodskey3pageSize'  @on-change="goodskey3getData" @on-page-size-change="goodskey3changePageSize"></Page>
                                </div>
                              </div>
                            </div>

                    </div>
                    <!--状态-->
                        <!-- <div class="lanren" :class="{bgd1:storeDetails.status==1,bgd2:storeDetails.status==99}">
                           <span >{{storeDetails.statusDesc}}</span>
                        </div>​ -->

				</div>

		<!--关联商品的弹框-->
			<Modal v-model="glskuisshow" height="300" width="800px" :mask-closable='false' :closable='false' >
				<p slot="header">

					<span>关联商品</span>
				</p>
				<div style="position:relative;text-align:center;width:100%;height:35px;line-height:35px;display:flex;">
					<Input v-model='skuKeyword' class="modelInput" @on-enter='serarsku' placeholder="客户名称/编码" style="padding:2px 0"></Input>
					<span @click='searchSku'>
					<Icon type="search" size="16" style="cursor:pointer;display:inline-block;position:absolute;top:10px;right:18px;z-index:9" ></Icon>

					</span>
				</div>
				<div slot="footer">
					<div class="table1" >
						<div class="detail-title-mark">
						<div v-for="(item,index) in title5" class="detail-title" @click="addborder5(index)" :class="{bor:index==num5}">
										{{item}}
						</div>
						</div>
						<!--可选商品-->
						<div v-if="num5==0" class="detail-public" style='margin-top:-10px'>
							 <span class='quotationaddLength'>{{goodskey1total}}</span>
							<Table size="small" border highlight-row height="300"  :columns="kxskukey" :data="kxskudata" >
								</Table>
								<div class="page-box">
    							 <Page :total="gystotal" show-total size="small" :pageSize='gyspageSize'  @on-change="getgysData" @on-page-size-change="changegysPageSize">
    							 </Page>
    						</div>
						</div>
						<!--已选商品-->
						<div v-if="num5==1" class="detail-public" style='margin-top:-10px'>
							<span class='quotationaddLength'>{{goodskey1total}}</span>
							<Table size="small" border  height="300"  :columns="yxskukey" :data="yxskudata" >
							</Table>
              
            </div>

					</div>
					<div class='title' style='margin:10px'>
						<div style='color:#D15151;font-size:14px'>
              <!-- <Icon type="plus" style='margin-right:5px'></Icon>
							<span @click='addglsku'>添加商品</span> -->
            </div>
						<div>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='glskucancel'><Icon type="close" style="margin-right:5px;" ></Icon>取消</Button>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#3b77e3;color:#fff" @click="sureglsku"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>确认</Button>
						</div>
					</div>
				</div>
			</Modal>
			<!--新建客户商品-->
			<Modal v-model="skuaddisshow" width="660px" :mask-closable='false' :closable='false'>
				<p slot="header">
					<span>新建客户商品</span>
				</p>
				<div slot="footer">
					<Row>
						 <Col span="6">
							<div class='right-left'>
								<el-upload
								  class="avatar-uploader"
								 :action="logoUrl"
								name='file'
								  :show-file-list="false"
								  :on-success="addsucess"
								  >
								  <img v-if="mainPhoto" :src="mainPhoto" class="avatar" width='80' height='80'>
								  <i v-else class="el-icon-plus avatar-uploader-icon"></i>
								</el-upload>

							</div>
						</Col>
						<Col span="18">
						<Form ref="fsku" :model="skuformValidate" :rules="skuskuruleValidate" :label-width="120">
							<FormItem label="名称" prop="name">
                	<Input v-model="skuformValidate.name" placeholder="仓库名称"></Input>
           		 </FormItem>
           		 <FormItem label="价格" prop="price">
                	<Input v-model="skuformValidate.price" number placeholder="仓库名称"></Input>
           		 </FormItem>
           		 <FormItem label="单位" prop="unit">
                	<Input v-model="skuformValidate.unit" placeholder="单位"></Input>
           		 </FormItem>
           		 <FormItem label="条码" prop="barcode">
                	<Input v-model="skuformValidate.barcode" placeholder="条码"></Input>
           		 </FormItem>
           		 <FormItem label="库存上限" prop="inventoryUp">
                	<Input v-model="skuformValidate.inventoryUp" number placeholder="库存上限"></Input>
           		 </FormItem>
						</Form>
				    	</Col>
					</Row>
					<div class='title'>
						<div style='color:#D15151;font-size:14px'>
							</div>
						<div>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='glskucancel1'><Icon type="close" style="margin-right:5px;" ></Icon>关闭</Button>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#3b77e3;color:#fff" @click="sureglsku1('fsku')"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>添加</Button>
						</div>
					</div>
				</div>
			</Modal>
			<!--客户弹框-->
			<Modal v-model="khisshow" width="660px">
				<p slot="header" style="height:30px;line-height:30px">

					<span>客户搜索</span>
				</p>
				<div style="position:relative;text-align:center;width:100%;height:35px;line-height:35px;display:flex;">
					<input v-model="gyskeyword" class="modelInput" placeholder="客户名称/编码" style="padding:2px 0"/>
					<span @click="getgysKeyword">
					<Icon type="search" size="16" style="display:inline-block;position:absolute;top:10px;right:18px;z-index:9" ></Icon>

					</span>
				</div>
				<div slot="footer">
					<!--客户表格-->
					<Table  border highlight-row height="300" :columns="gyskey" :data="gysdata" @on-row-click="gysrow">
					</Table>

					<div class='title'>
						<div style='color:#D15151;font-size:14px'><Icon type="plus" style='margin-right:5px'></Icon>
						<!-- 	<span >添加客户</span> -->
            </div>
						<div>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='modelCancel'><Icon type="close" style="margin-right:5px;" ></Icon>取消</Button>
							<Button shape="circle" type="ghost" style="display:inline-block;background:#3b77e3;color:#fff" @click="makegys"><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>添加</Button>
						</div>
					</div>
				</div>
			</Modal>
       <!--保存地址-->
      <Modal v-model="saveaddressisshow" width="460px" >
        <p slot="header" style="height:30px;line-height:30px">
          <span>新增地址</span>
        </p>
        <Form ref="xiaoshousave" :model="xiaoshouformValidate" :rules="xiaoshouruleValidate" :label-width="80" >
           <FormItem label="地址" prop="addressCountry">
            <el-cascader
              filterable
              expand-trigger="click"
              :options="cityInfo"
              v-model="selectedOptions3"
              @change="handleChange1" style="width:100%">
            </el-cascader>
            
          </FormItem> 
          <FormItem label="详细地址" prop="addressAddress">
             <Input type="text" v-model="xiaoshouformValidate.addressAddress" placeholder="请输入详细地址"></Input>
          </FormItem>
          <FormItem label="联系人"  prop="addressName">
                <Input  v-model="xiaoshouformValidate.addressName" placeholder="请输入联系人姓名" ></Input>
          </FormItem>
          <FormItem label="联系手机"  prop="addressMobile">
                <Input  v-model="xiaoshouformValidate.addressMobile" placeholder="请输入联系手机" ></Input>
          </FormItem>
          <FormItem label="联系电话" prop="addressPhone">
                <Input  v-model="xiaoshouformValidate.addressPhone" placeholder="请输入联系电话" ></Input>
          </FormItem>
          <FormItem label="设为默认">
              <Checkbox v-model='isdefault' @on-change="changeisdefault"></Checkbox>
          </FormItem>
        </Form>
        <div slot="footer">
          <div class='title' style='margin-top:-20px'>
            <div style='color:#D15151;font-size:14px'>
              </div>
            <div>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelAddress'><Icon type="close" style="margin-right:5px;" ></Icon>取消</Button>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#3b77e3;color:#fff" @click="saveAddRess('xiaoshousave')" ><Icon type="checkmark-round" style=";margin-right:5px;color:#fff"></Icon>保存</Button>
            </div>
          </div>
        </div>
      </Modal>
      <!--修改地址-->
      <Modal v-model="addressisshow" width="460px" >
        <p slot="header" style="height:30px;line-height:30px">
          <span>修改地址</span>
        </p>
         <Form ref="xiaoshousave1" :model="xiaoshouformValidate" :rules="xiaoshouruleValidate" :label-width="80" >
          <FormItem label="地址" prop="addressCountry">
              <el-cascader
              filterable
              expand-trigger="click"
              :options="cityInfo"
              v-model="selectedOptions3"
              @change="handleChange1" style="width:100%">
            </el-cascader>
           
          </FormItem>
          <FormItem label="详细地址" prop='addressAddress'>
              <Input type="text" v-model="xiaoshouformValidate.addressAddress" placeholder="请输入详细地址"></Input>
          </FormItem>
          <FormItem label="联系人"  prop="addressName">
                <Input  v-model="xiaoshouformValidate.addressName" placeholder="请输入联系人姓名" ></Input>
          </FormItem>
          <FormItem label="联系手机"  prop="addressMobile">
                <Input  v-model="xiaoshouformValidate.addressMobile" placeholder="请输入联系手机" ></Input>
          </FormItem>
          <FormItem label="联系电话">
                <Input  v-model="xiaoshouformValidate.addressPhone" placeholder="请输入联系电话" ></Input>
          </FormItem>
        </Form>
        <div slot="footer">
          <div class='title' style='margin-top:-20px'>
            <div style='color:#D15151;font-size:14px'>
              </div>
            <div>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#ACACAC;border:none;color:#fff" @click='cancelAddress'><Icon type="close" style="margin-right:5px;" ></Icon>取消</Button>
              <Button shape="circle" type="ghost" style="display:inline-block;background:#40ca98;color:#fff" @click="editAddress('xiaoshousave1')" ><i class="el-icon-edit" style=";margin-right:5px;"></i>修改</Button>
            </div>
          </div>
        </div>
      </Modal>
        <!--精准搜索-->
    <Modal v-model="psisshow" width="360px">
      <p slot="header" style="height:30px;line-height:30px;text-align:center">

        <span>精准搜索</span>
      </p>
       <Form :label-width="100">

          <FormItem label="客户名称：" >
             <Input v-model='supplierName' ></Input>
          </FormItem>
          <FormItem label="联系人手机：" >
             <Input v-model='supplierContractPhone' ></Input>
          </FormItem>
      </Form>
      <div slot="footer">
        <div class='footer-mark'>
          <span><a style='color:#999;font-size:14px' @click='cancelSearchLocation'>取消</a></span>
          <span style='font-size:20px;width:1px;height:40px;background:#e4e4e4'></span>
          <span ><a style='color:#3B77E3;font-size:14px' @click='sureSearchLocation'>确认</a></span>
        </div>
      </div>
    </Modal>
    <!--账号管理-->
    <Modal v-model="loginModel" width="400px">
      <p slot="header" style="height:30px;line-height:30px;text-align:center">
        <span>账号管理</span>
      </p>
       <Form ref="formValidatelogin" :model="formValidatelogin" :rules="ruleValidatelogin" :label-width="100">
        <FormItem label="登陆用户名" prop="loginname">
           <Input style='' disabled v-model='formValidatelogin.loginname' ></Input>
        </FormItem>

        <FormItem label="手机号验证" >
           <Input style='' disabled v-model='user.mobile'></Input>
        </FormItem>
        <FormItem label="验证码" prop="loginphone">
          <div style='display:flex'>
           <Input style='width:100px;margin-right:20px' placeholder='请输入验证码' v-model='formValidatelogin.loginphone'></Input>
           <Button  type="primary" style="background:#3b77e3;border:none:color:#fff" v-if='yzm' @click='sendYzm'>获取验证码</Button>
           <Button  type="primary" style="background:#f5f5f5;border:none:color:#fff" v-if='yzm1' disabled>{{yzmnumber}}秒后重试</Button>
           </div>
        </FormItem>
        <FormItem label="新密码" prop="loginNewPass">
          <Input placeholder='请输入新密码' v-model='formValidatelogin.loginNewPass' type='password'></Input>
        </FormItem>
      </Form>
      <div slot="footer">
        <div class='footer-mark'>
          <span><a style='color:#999;font-size:14px' @click='cancelPs'>取消</a></span>
          <span style='font-size:20px;width:1px;height:40px;background:#e4e4e4'></span>
          <span ><a style='color:#3B77E3;font-size:14px' @click='savePs("formValidatelogin")'>密码重置</a></span>
        </div>
      </div>
    </Modal>
      <div class='tot'>
        <span>共<span style='color:#ff0000'> {{total}} </span>条</span>
        <span>当前第<span style='color:#ff0000'> {{current}} </span>页</span>
    </div>
		</div>

	</div>
</template>

<script>

import LoadUrl from '@/components/common/actionLoad'
 import { regionData,CodeToText,TextToCode} from 'element-china-area-data'
	export default {
		data() {
			return {
        activeName:'1',
        cancelxiu:false,
        yzmnumber:60,
        yzm:true,//获取验证码
        yzm1:false,//显示剩余的秒数
        user:this.$store.state.common.user,
        //详情账号管理弹框
        loginModel:false,
        formValidatelogin:{
          loginname:"",
          loginphone:"",//验证码
          loginNewPass:""
        },
        ruleValidatelogin:{
          loginphone:[{ required: true, message: '请填写验证码', trigger: 'blur' }],
          loginNewPass:[ { required: true, message:this.$t('public.pssEmpty'), trigger: 'blur' }],
        },
        dis:false,
        CodeToText:CodeToText,//code转为Text
        TextToCode:TextToCode,//Text转为code
        cityInfo:regionData,//地址数据
        selectedOptions2:[],//绑定的数据
        isstart:false,//是否是启用
        isstop:false,//是否为停用
        psisshow:false,
        supplierName:'',///精准搜索客户名称
        supplierContractPhone:'',////精准搜索客户手机
        searchKeyword:'',
        upBtn:false,//上传附件，修改:
        chaIndex:-1,
        soe:false,
        upData:[],
        upData1:[],
        actionUrl:LoadUrl.httpPrefix.Url+'file/action/upload?uid='+this.$store.state.common.token,//导入地址
        addressIndex:-1,
        saveaddressisshow:false,//保存的弹框
        addressisshow:false,//地址修改的弹框
				skuKeyword:'',//商品搜索关键词
				//添加商品数据
				skuformValidate:{
					name:'',//商品名称
					price:'',//价格
					barcode:'',//条码
					unit:'',//单位
					inventoryUp:'',//库存上限
				},
				//添加商品数据验证
				skuskuruleValidate:{
					name:[{ required: true, message: '商品名称不能为空', trigger: 'blur' }],
					price:[{ required: true, message: '价格不能为空', trigger: 'blur' }],
					unit:[{ required: true, message: '单位不能为空', trigger: 'blur' }],
				},
				khlevel:[],//客户等级
        khclassify:[],//客户类型
        //客户地址数据
        customerAddressData:[{}],
				//注册信息
        level:'',//客户等级
          classify:'',//客户类型
				formValidate:{

					swdjh:'',//税务登记号
					email:'',//邮箱
					youbian:'',//邮编
					credits:0,//信用额度
					invoiceTitle:'',//发票抬头
					khh:'',//开户行
					regAddress:'',//注册场所地址
					regTel:'',//注册固定电话
          code:"",//编码
          name:'',//供应商名称
          contractPhone:'',//手机
          contractTel:'',//电话
          swdjh:'',//税务登记号
          email:'',//邮箱
          youbian:'',//邮编
          credits:0,//信用额度
          invoiceTitle:'',//发票抬头
          khh:'',//开户行
          regAddress:'',//注册场所地址
          regTel:'',//注册固定电话
          
          contract:'',//联系人
          payment:'',//应付金额
          receivable:'',//应收金额
          contractFax:'',//联系人传真
          contractEmail:'',//联系人邮箱^[a-z0-9]+([._\\-]*[a-z0-9])*@([a-z0-9]+[-a-z0-9]*[a-z0-9]+.){1,63}[a-z0-9]+$
          contractPosition:'',//联系人职位
          contractAddress:'',//联系人地址
          loginName:"",//登陆账号
          pass:"",//密码
				},
				//验证规则
				ruleValidate:{
          loginName:[ { required: true, message: '登陆账号不能为空', trigger: 'blur' }],
          pass:[{ pattern: /^[0-9a-zA-Z]+$/, message: '密码应为数字或字母' }, { required: true, message:this.$t('public.pssEmpty'), trigger: 'blur' }],
					name:[
            { required: true, message: '客户名称不能为空', trigger: 'blur' },
            { pattern:/^[A-Za-z\d_\-\u4e00-\u9fa5]{1,20}$/, message: '存在非法字符或超过指定长度20个字符' }
          ],
          contract:[
            { required: true, message: '联系人不能为空', trigger: 'blur' },
            { pattern:/^[A-Za-z\d_\-\u4e00-\u9fa5]{1,20}$/, message: '存在非法字符或超过指定长度20个字符' }
          ],
          contractEmail:[{ type: 'email', message: '请输入正确的邮箱', trigger: 'blur' }
          ],
          contractPhone:[
                     { required: true, message: '手机号不能为空', trigger: 'blur' },
                   { pattern: /^1[3|4|5|7|8][0-9]{9}$/, message: '请输入正确的手机号码' }
          ],
          contractTel:[
                { pattern: /(^[0-9]{3,4}\-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^\([0-9]{3,4}\)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$)/, message: '请输入正确的电话号码' }
          ],
					regTel:[
                 
                  { pattern: /(^[0-9]{3,4}\-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^\([0-9]{3,4}\)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$)/, message: '请输入正确的注册固定电话' }
                ],
				},
				//////
				logoUrl:LoadUrl.httpPrefix.Url+'file/action/upload/image/url?c=客户商品图片&uid='+this.$store.state.common.token,
				loading:"暂无数据",
				price:0,
				// kh:[],//客户数据
				inventoryUp:0,
				unit:'',
				skuAttributeList:[],
				khisshow:false,
				gyskeyword:'',
				gystotal:0,
				gyspageSize:0,
				//客户key
				gysdata:[],
				gyskey:[
					{
	                	title:"客户名称1",
	                	ellipsis:true,
	                	key:"name"
                	},
                	{
	                	title:"主要联系人手机",
	                	ellipsis:true,
	                	key:"contractPhone"
                	},
                	{
	                	title:"主要联系人电话",
	                	ellipsis:true,
	                	key:"contractTel"
                	},
				],
				khName:'',
				skuaddisshow:false,
				barcode:"",
				barnd:"",
				mainPhoto:"",
				skuCode:"",
				skuName:"",
				skuId:"",

				glskuisshow:false,
				title5:['可选商品','已选商品'],
				kxskudata:[],//可选商品数组
				yxskudata:[],//已选商品数组
        isdisabled:false,
				kxskukey:[
                 {
                    title:'操作',
                    key:"actiion",
                    width:80,
                    render:(h,params)=>{
                      return h('Button',{
                        props:{
                          type:"primary",
                          // disabled:this.isdisabled
                        },
                        on:{
                          'click':()=>{
                            console.log(params.row)
                              let arr={
                                    barcode:params.row.barcode,
                                    barnd:params.row.barnd,
                                    createTime:params.row.createTime,
                                    status:params.row.status,
                                    statusDesc:params.row.statusDesc,
                                    mainPhoto:params.row.mainPhoto,
                                    partnerId:this.id,
                                    skuCode:params.row.skuCode,
                                    skuId:params.row.id,
                                    skuName:params.row.skuName,
                                    skuVo:{
                                        skuCode:params.row.skuCode,
                                        skuId:params.row.id,
                                        skuName:params.row.skuName,
                                        price:params.row.price,
                                        costPrice:params.row.costPrice,
                                        wholePrice:params.row.wholePrice,
                                        unit:params.row.unit,
                                        unitId:params.row.unitId,
                                        className:params.row.className,
                                        classId:params.row.classId,
                                        inventoryUp:params.row.inventoryUp,
                                        inventory:params.row.inventory,
                                        barcode:params.row.barcode,
                                        barnd:params.row.barnd,
                                        mainPhoto:params.row.mainPhoto,
                                        photos:params.row.photos,
                                        unitList:params.row.unitList,
                                        unitDesc:params.row.unitDesc,
                                        attrDetailList:params.row.attrDetailList,
                                        partnerId:this.id,
                                        specs:params.row.specs,
                                      }
                                  }
                              this.axios.post('client/addsku?uid='+this.uid,arr).then(res=>{
                                  if(res.data.status==200){
                                   this.getglsku()
                                  }else{
                                    this.$notify({
                                          title:"",//
                                          message:res.data.errorMessage,
                                          type: 'error',
                                          position: 'bottom-right'
                                      });
                                  }
                                })
                          }
                        }
                      },'选取')
                    }
                  },

                  {
                        title: '',
                        key:'mainPhoto',
                         width: 80,
                        align: 'center',
                        render:(h, params) =>{
                          return h('div',[
                              h('img',{
                                attrs:{
                                  src:params.row.mainPhoto
                                },
                                style:{
                                  width:'40px',
                                  height:'40px',
                                  marginTop:'4px'
                                }
                              })
                            ])
                        }
                    },
                      {
                        title: this.$t('manage.sku.SkuCode'),//'货号',

                        key:'skuCode',
                    width: 120,
                    },
                    {
                        title: this.$t('manage.sku.SkuName'),//'名称',
                        ellipsis:true,
                        key:'skuName',
                    width: 190,
                    },
                    {
                        title: this.$t('manage.sku.costprice'),//'成本价',
                        key:'costPrice',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.price'),//'吊牌价',
                        key:'price',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.wholeprice'),//'批发价',
                        key:'wholePrice',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.SkuUnit'),//'单位',

                        key:'unit',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.barnd'),//'品牌',

                        key:'barnd',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.FL'),//'分类',

                        key:'className',
                    width: 80,
                    },
                    {
                        title:"库存",//'库存',

                        key:'inventory',
                    width: 100,
                    },
                   
				],
				yxskukey:[
                {
                    title:'操作',
                    key:"actiion",
                     width: 80,
                    render:(h,params)=>{
                      return h('Button',{
                        props:{
                          type:"primary"
                        },
                        style:{
                          background:'#d53c39',
                          border:"none"
                        },
                        on:{
                          'click':()=>{
                           
                            //////console.log(params)
                            this.axios.delete('client/deletesku/'+params.row.id+'?uid='+this.uid).then(res=>{
                              if(res.data.status==200){
                                this.$notify({
                                  title:"",//
                                  message: this.$t('public.deleteSuccess'),//
                                  type: 'success',
                                  position: 'bottom-right'
                              });
                                  this.getglsku()
                                  this.kxskudata.splice(params.index,1)
                              }else{
                                this.$notify({
                                  title:"",//
                                  message: res.data.errorMessage,
                                  type: 'error',
                                  position: 'bottom-right'
                              });
                              }
                            })
                            // this.yxskudata.splice(params.index,1)
                          }
                        }
                      },'删除')
                    }
                  },
                  {
                        title: '',
                        key:'mainPhoto',
                         width: 80,
                        align: 'center',
                        render:(h, params) =>{
                          return h('div',[
                              h('img',{
                                attrs:{
                                  src:params.row.mainPhoto
                                },
                                style:{
                                  width:'40px',
                                  height:'40px',
                                  marginTop:'4px'
                                }
                              })
                            ])
                        }
                    },
                      {
                        title: this.$t('manage.sku.SkuCode'),//'货号',

                        key:'skuCode',
                    width: 120,
                    },
                    {
                        title: this.$t('manage.sku.SkuName'),//'名称',
                        ellipsis:true,
                        key:'skuName',
                    width: 190,
                    },
                    {
                        title: this.$t('manage.sku.costprice'),//'成本价',
                        key:'costPrice',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.price'),//'吊牌价',
                        key:'price',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.wholeprice'),//'批发价',
                        key:'wholePrice',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.SkuUnit'),//'单位',

                        key:'unit',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.barnd'),//'品牌',

                        key:'barnd',
                    width: 80,
                    },
                    {
                        title: this.$t('manage.sku.FL'),//'分类',

                        key:'className',
                    width: 80,
                    },
                   
                    
				],
				num5:0,
				goodskey1total:0,
				goodskey1pageSize:0,
				goodskey2pageSize:0,
				goodskey2total:0,
				selectedgoodsrow1:[],
				goodskey1:[
			      {
                title: '',
                key:'mainPhoto',
                width: 80,
                align: 'center',
                render:(h, params) =>{
                  return h('div',[
                      h('img',{
                        attrs:{
                          src:params.row.mainPhoto
                        },
                        style:{
                          width:'40px',
                          height:'40px',
                          marginTop:'4px'
                        }
                      })
                    ])
                }
              },
                {
                  title: this.$t('manage.sku.SkuCode'),//'货号',

                  key:'skuCode',
       
              },
              {
                  title: this.$t('manage.sku.SkuName'),//'名称',
                  ellipsis:true,
                  key:'skuName',
         
              },
              {
                  title: this.$t('manage.sku.costprice'),//'成本价',
                  key:'costPrice',
                  ellipsis:true,
              },
              {
                  title: this.$t('manage.sku.price'),//'吊牌价',
                  key:'price',
                  ellipsis:true,
              },
              {
                  title: this.$t('manage.sku.wholeprice'),//'批发价',
                  key:'wholePrice',
                  ellipsis:true,
              },
              {
                  title: this.$t('manage.sku.SkuUnit'),//'单位',

                  key:'unit',
                  ellipsis:true,
              },
              {
                  title: this.$t('manage.sku.barnd'),//'品牌',

                  key:'barnd',
                  ellipsis:true,
              },
              {
                  title: this.$t('manage.sku.FL'),//'分类',

                  key:'className',
                  ellipsis:true,
              },
              
		         {
            	title:'操作',
            	key:"actiion",
                width: 80,
            	render:(h,params)=>{
            		return h('Button',{
            			props:{
            				type:"primary"
            			},
                  style:{
                    background:'#d53c39',
                    border:"none"
                  },
            			on:{
            				'click':()=>{
            					this.axios.delete('client/deletesku/'+params.row.id+'?uid='+this.uid).then(res=>{
            						if(res.data.status==200){

                          this.$notify({
                            title:"",//
                            message: this.$t('public.deleteSuccess'),//
                            type: 'success',
                            position: 'bottom-right'
                        });
    												this.getglsku()
                				}else{
                              this.$notify({
                                title:"",//
                                message: res.data.errorMessage,
                                type: 'error',
                                position: 'bottom-right'
                            });
            						}
            					})
            				
            				}
            			}
            		},'删除')
            	}
            }
				],
        //报价商品
        goodskey3total:0,
        goodskey3pageSize:0,
        selectedgoodsrow3:[],
        goodskey3:[
             {
              title: '图片',
              key:'mainPhoto',
               width: 80,
              align: 'center',
              render:(h, params) =>{
                return h('div',[
                    h('img',{
                      attrs:{
                        src:params.row.mainPhoto
                      },
                      style:{
                        width:'40px',
                        height:'40px',
                        marginTop:'4px'
                      }
                    })
                  ])
              }
          },
          {
            title:"货号",
            key:"skuCode"
          },
          {
            title:"条码",
            key:"barcode"
          },

          {
            title:"名称",
          
            key:"skuName"
          },
          {
            title:"成本价",
          
            key:"costPrice"
          },
          {
            title:"批发价",
          
            key:"wholePrice"
          },
          {
            title:"报价",
            key:"price",
            align: 'center',
          },
          {
            title:"品牌",
            key:"barnd",
            align: 'center',
          },

        ],
				selectedgoodsrow2:[],
				goodskey2:[
					{
						title:"单据编号",
						key:"recordNo"
					},
					{
						title:"单据日期",
						key:"recordDate"
					},
          {
            title:"客户",
            key:"name1"
          },
					{
						title:"手机",
						key:"mobile"
					},
					
					{
						title:"开始时间",
						key:"startTime"
					},
					{
						title:"结束时间",
						key:"endTime"
					},
          {
            title:"状态",
            key:"ststusDesc"
          },
				],

				xiugai:false,
				xiugaibtn1:false,
				xiugaibtn2:false,
				num4:0,
        valueT:1,
				orderListname:[
            {
                label:"全部",
                value:0
            },
            {
                label:"正常",
                value:1
            },
            {
                label:"已停用",
                value:2
            },

        ],
				detailsInfo:false,
				storeDetails:{},
				num3:0,
				titles1:['关联商品','报价单历史','常用地址','附件列表','报价商品'],
				num2:0,
				titles:['基本信息','备注'],
				height:'',
				current:1,
				total:0,
				pageSize:0,
				single:false,
				num: 1, //判断基本信息 联系人信息的样式
				numLeftList:-1,//左侧列表选中下标
				addNewUnits:"",
				unitsText:"新增客户",//新增供应商
				addText:true,
				unitsDetail: false, //供应商详细信息
				flag: 1, //概览   采购  联系人 备注  哪个显示
				newBusiness:false,
				columns: [{
						title: '订单编号',
						key: 'code'
					},
					{
						title: '参考号',
						key: 'ckhao'
					},
					{
						title: '日期',
						key: 'date'
					},
					{
						title: '金额',
						key: 'price'
					},
					{
						title: '状态',
						key: 'status'
					}
				],
				data:[],
				userList:[],//联系人列表
				Allunits: [], //往来单位列表
				id: '', //往来单位的id
				deAddress:"",//详细地址
				youbian:"",//邮编
				eyoubian:"",
				code: '',
				name: '',
				url: '',//网址
				yyzz: '',
				swdjh: '',//税务登记号
				khh: '',//默认开户行
				bankcode: '',//银行帐号
				address: '',
				statusDesc:0,
				contractTel: '',//单位电话
				// chuanzhen: '',
				email: '',
				zyaddress: '',
				remark: '',
				contractPhone:"",//往来联系人电话
				uid: this.$store.state.common.token,
        city:'',//市
        province:'',//省
        district:'',//区

        xiaoshouformValidate:{
          addressName:'',//联系人
          addressPhone:'',//联系电话
          addressMobile:'',//联系手机
          addressAddress:"",
          addressProvince:'',//省
          addressCity:'',//市
          addressCountry:'',//区
        },
        xiaoshouruleValidate:{
          addressName:[{ required: true, message: '联系人不能为空', trigger: 'blur' },{ pattern:/^[A-Za-z\d_\-\u4e00-\u9fa5]{1,20}$/, message: '存在非法字符或超过指定长度20个字符' }],
          addressPhone:[{ pattern: /(^[0-9]{3,4}\-[0-9]{3,8}$)|(^[0-9]{3,8}$)|(^\([0-9]{3,4}\)[0-9]{3,8}$)|(^0{0,1}13[0-9]{9}$)/, message: '请输入正确的电话号码' }],
          addressMobile:[{ required: true, message: '手机号码不能为空', trigger: 'blur' },{ pattern: /^1[3|4|5|7|8][0-9]{9}$/, message: '请输入正确的手机号码' }],
          addressAddress:[{ required: true, message: '地址不能为空', trigger: 'blur' }],
          addressCountry:[{ required: true, message: '地址不能为空', trigger: 'change' }]
        },
        
        selectedOptions3:[],
       
        value:'',
      
        AllAddress:[],//地址列表
        addressId:'',//地址ID
        isdefault:false,//保存是是否设置为默认地址
        attrid:'',//多附件id链接
			}
		},
		methods: {
      //点击新增地址弹框
			addr(){
        this.saveaddressisshow=true
        this.selectedOptions3=[]
        this.xiaoshouformValidate.addressName=''//联系人
        this.xiaoshouformValidate.addressPhone=''//联系电话
        this.xiaoshouformValidate.addressMobile=''//联系电话
        this.xiaoshouformValidate.addressProvince=''//省
        this.xiaoshouformValidate.addressCity=''//市
        this.xiaoshouformValidate.addressCountry=''//区
        this.xiaoshouformValidate.addressAddress=''//详细地址
        this.selectedOptions3=[]
      },
      //省市区
      handleChange(arr){
          this.province = this.CodeToText[arr[0]]
          this.city =this.CodeToText[arr[1]]
          this.district = this.CodeToText[arr[2]]

      },
      //常用地址省市区
      handleChange1(arr){
          this.xiaoshouformValidate.addressProvince = this.CodeToText[arr[0]]
          this.xiaoshouformValidate.addressCity =this.CodeToText[arr[1]]
          this.xiaoshouformValidate.addressCountry = this.CodeToText[arr[2]]

        },
      //保存是点击默认地址选中
      changeisdefault(v){
        this.isdefault=v
      },
      //保存地址
      saveAddRess(name){
        this.$refs[name].validate((valid) => {
          if(valid){
              if(this.id==''){
           this.$notify({
                title:"",//
                message: '请选择客户',
                type: 'error',
                position: 'bottom-right'
            });
        }else{
            this.axios.post('clienta/add?uid='+this.uid,{
              partnerId:this.id,
              name:this.xiaoshouformValidate.addressName,//联系人
              phone:this.xiaoshouformValidate.addressPhone,//联系电话
              mobile:this.xiaoshouformValidate.addressMobile,//联系手机
              province:this.xiaoshouformValidate.addressProvince,//省
              city:this.xiaoshouformValidate.addressCity,//市
              country :this.xiaoshouformValidate.addressCountry ,//区
              address:this.xiaoshouformValidate.addressAddress,//详细地址
              default:this.isdefault//是否设置为默认地址
            }).then(res=>{
              if(res.data.status==200){
                  this.getAllAddress(this.id)
                  this.xiaoshouformValidate.addressName=''//联系人
                  this.xiaoshouformValidate.addressPhone=''//联系电话
                  this.xiaoshouformValidate.addressMobile=''//联系电话
                  this.xiaoshouformValidate.addressProvince=''//省
                  this.xiaoshouformValidate.addressCity=''//市
                  this.xiaoshouformValidate.addressCountry=''//区
                  this.xiaoshouformValidate.addressAddress=''//详细地址
                  this.selectedOptions3=[]
                  this.isdefault=false//详细地址
                  this.saveaddressisshow=false
              }else{

                this.$notify({
                  title:"",//
                  message:res.data.errorMessage,
                  type: 'error',
                  position: 'bottom-right'
              });
              }
            })
          }
          }
        })
      },
      //点击修改获取id详情
      editAddressBtn(id){
        this.axios.get('clienta/get/'+id+'?uid='+this.uid).then(res=>{
          if(res.data.status==200){
            let data=res.data.rows
            //console.log(data)
            this.xiaoshouformValidate.addressName=data.name
            this.xiaoshouformValidate.addressPhone=data.phone
            this.xiaoshouformValidate.addressMobile=data.mobile
            this.xiaoshouformValidate.addressProvince=data.province
            this.xiaoshouformValidate.addressCity=data.city
            this.xiaoshouformValidate.addressCountry=data.country
            this.xiaoshouformValidate.addressAddress=data.address
            //转为code
            if(this.xiaoshouformValidate.addressProvince==null||this.xiaoshouformValidate.addressProvince=='' || this.xiaoshouformValidate.addressCity==null||this.xiaoshouformValidate.addressCity=='' || this.xiaoshouformValidate.addressCountry==null||this.xiaoshouformValidate.addressCountry==''){
              this.selectedOptions3=[]
            }else{
               this.selectedOptions3=[this.TextToCode[this.xiaoshouformValidate.addressProvince].code,this.TextToCode[this.xiaoshouformValidate.addressProvince][this.xiaoshouformValidate.addressCity].code,this.TextToCode[this.xiaoshouformValidate.addressProvince][this.xiaoshouformValidate.addressCity][this.xiaoshouformValidate.addressCountry].code]
            }

          }
        })
        this.addressId=id
        this.addressisshow=true

      },
      //删除地址paddress/delete/23
      deleteAddressBtn(id){
         this.axios.delete('clienta/delete/'+id+'?uid='+this.uid).then(res=>{
          if(res.data.status==200){
            this.getAllAddress(this.id)
            this.$notify({
               title:"",//
                message: '删除地址成功',
                type: 'success',
                position: 'bottom-right'
            });
          }else{
            this.$notify({
               title:"",//
                message: res.data.errorMessage,
                type: 'error',
                position: 'bottom-right'
            });
          }
         })
      },
      //执行修改
      editAddress(name){
         this.$refs[name].validate((valid) => {
            if(valid){
                this.axios.put('clienta/update?uid='+this.uid,{
                  id:this.addressId,
                  name:this.xiaoshouformValidate.addressName,//联系人
                  phone:this.xiaoshouformValidate.addressPhone,//联系电话
                  mobile:this.xiaoshouformValidate.addressMobile,//联系电话
                  province:this.xiaoshouformValidate.addressProvince,//省
                  city:this.xiaoshouformValidate.addressCity,//市
                  country:this.xiaoshouformValidate.addressCountry,
                  address:this.xiaoshouformValidate.addressAddress,//详细地址
        }).then(res=>{
                if(res.data.status==200){
                  this.$notify({
                      title:"",//
                      message: '修改地址成功',
                      type: 'success',
                      position: 'bottom-right'
                  });
                  this.getAllAddress(this.id)
                  this.addressisshow=false
                  this.xiaoshouformValidate.addressName=''//联系人
                  this.xiaoshouformValidate.addressPhone=''//联系电话
                  this.xiaoshouformValidate.addressMobile=''//联系电话
                  this.xiaoshouformValidate.addressProvince=''//省
                  this.xiaoshouformValidate.addressCity=''//市
                  this.xiaoshouformValidate.addressCountry=''//区
                  this.xiaoshouformValidate.addressAddress=''//详细地址
                  this.selectedOptions3=[]
                  this.isdefault=false//详细地址
                  this.saveaddressisshow=false
                }else{
                  this.$notify({
                      title:"",//
                      message: res.data.errorMessage,
                      type: 'error',
                      position: 'bottom-right'
                  });
                }
              })
            }
         })
        
      },
      //取消修改地址
      cancelAddress(){
        this.addressisshow=false
        this.saveaddressisshow=false
      },
      //默认地址选中
      defaultAddress(id){
        this.addressId=id
        this.axios.get('clienta/default/'+id+'?uid='+this.uid).then(res=>{
          if(res.data.status==200){
            this.getAllAddress(this.id)//设置默认地址后刷新地址列表
          }
        })

      },
      //获取地址列表
      getAllAddress(id){
        this.axios.get('clienta/query/'+id+'?uid='+this.uid).then(res=>{
          if(res.data.status==200){
            this.AllAddress=res.data.rows
          }
        })
      },
			//获取客户列表信息
			getUnitsList() {
				this.axios.get('/client/query?cl='+this.valueT+'&uid=' + this.uid).then((res) => {
					let data = res.data;
					if(res.data.status == '200') {
							this.Allunits = data.rows;
							this.pageSize = data.pageSize;
							this.total = data.total;

							this.Allunits.forEach(item=>{

								item.createTime=new Date(item.createTime).toLocaleDateString().replace(/\//g,'-')
							})
						 
					}
				})
			},
      //获取客户列表信息
      getUnitsListS() {
        this.axios.get('/client/query?cl=0'+'&uid=' + this.uid).then((res) => {
          let data = res.data;
          if(res.data.status == '200') {
              this.Allunits = data.rows;
              this.pageSize = data.pageSize;
              this.total = data.total;
              this.Allunits.forEach(item=>{
                item.createTime=new Date(item.createTime).toLocaleDateString().replace(/\//g,'-')
              })
             this.updataUnit(this.Allunits[0].id,0)
          }
        })
      },
			//点击新建
			addUnit(){
				// this.details=false
				this.detailsInfo=false
        this.addText = true
				this.upBtn = true//附件按钮
				this.newBusiness = false
				this.xiugai=false
				this.xiugaibtn1=false
				this.xiugaibtn2=false
				this.unitsText = "新增客户"
				this.formValidate.name=''//客户名称
				this.formValidate.contractPhone=''//手机
				this.formValidate.contractTel=''//电话
				this.formValidate.swdjh=''//税务登记号
        this.level=this.khlevel[0].value
        this.classify=this.khclassify[0].value
        // this.getkhlevel()//客户等级
        // this.getkhclassify()//客户类型
				// email:this.formValidate.email,//邮箱
				// youbian:this.formValidate.youbian,//邮编
				this.formValidate.credits=0//信用额度
				this.formValidate.invoiceTitle=''//发票抬头
				this.formValidate.khh=''//开户行
				this.formValidate.regAddress=''//注册场所地址
				this.formValidate.regTel=''//注册固定电话
        this.formValidate.contract=''//联系人
        this.formValidate.payment=''//应付金额
        this.formValidate.receivable=''//应收金额
        this.formValidate.contractFax=''//联系人传真
        this.formValidate.contractEmail=''//联系人邮箱
        this.formValidate.contractPosition=''//联系人职位
        this.formValidate.contractAddress=''//联系人地址
        this.formValidate.loginName=''//账号
        this.formValidate.pass=''//密码
        this.address=''
        this.formValidate.code='',
        this.upData=[]
        this.upData1=[]
        this.attrid=''
        this.selectedOptions2=[]
        this.address=''
			},

			//双击左侧列表
			updataUnit(id,index){
				this.numLeftList =index
				this.id = id
				this.addText = false;
				this.newBusiness = true
				this.detailsInfo=true
				// this.$refs.details.style.display='block'
				this.upBtn=false
				this.xiugai=false
				this.xiugaibtn2=false
				this.xiugaibtn1=true
        this.cancelxiu=false
				this.getUnitDefault(id)//获取客户详情
				this.getglsku(id) //关联商品
    
			},

			//获取客户详情
			getUnitDefault(id){
					this.axios.get('/client/get/' + id + '?uid=' + this.uid).then((res) => {
            if(res.data.status == '200') {
            let data = res.data.rows;
            this.storeDetails=data
            this.unitsText = data.name
            this.upData=data.fileList//修改显示的数组
            this.upData1=data.fileList//详情显示的附件数组
           	this.formValidate.name=data.name//客户名称
  					this.formValidate.contractPhone=data.contractPhone//手机
  					this.formValidate.contractTel=data.contractTel//电话
  					this.formValidate.swdjh=data.taxNo//税务登记号

                    
            if(data.level==''){
              this.level=this.khlevel[0].value
            }else{
              this.level=data.level//客户等级
            }
  					if(data.classify==''){
              this.classify=this.khclassify[0].value
            }else{
              this.classify=data.classify//客户等级
            }
            
            //console.log(this.formValidate.level)
  					// email:this.formValidate.email,//邮箱
  					// youbian:this.formValidate.youbian,//邮编
  					this.formValidate.credits=data.credits//信用额度
  					this.formValidate.invoiceTitle=data.invoiceTitle//发票抬头
  					this.formValidate.khh=data.bank//开户行
  					this.formValidate.regAddress=data.regAddress//注册场所地址
  					this.formValidate.regTel=data.regTel//注册固定电话
            this.formValidate.contract=data.contract//联系人
            this.formValidate.payment=data.payment//应付金额
            this.formValidate.receivable=data.receivable//应收金额
            this.formValidate.contractFax=data.contractFax//联系人传真
            this.formValidate.contractEmail=data.contractEmail//联系人邮箱
            this.formValidate.contractPosition=data.contractPosition//联系人职位
            this.formValidate.contractAddress=data.contractAddress//联系人地址
            this.formValidate.code=data.code
            this.address=data.address
            this.formValidate.loginName=data.accountName//账号
            this.formValidatelogin.loginname=data.accountName//详情修改的账号
            this.formValidate.pass=data.loginPs//密码
             //接收地址
              this.province=data.province
              this.city=data.city
              this.district=data.district
              //转为code
              if(this.province==null||this.province=='' || this.city==null ||this.city=='' || this.district==null||this.district==''){
                this.selectedOptions2=[]

              }else{
                this.selectedOptions2=[this.TextToCode[this.province].code,this.TextToCode[this.province][this.city].code,this.TextToCode[this.province][this.city][this.district].code]
              }
            if(data.status==1){
              this.isstart=false
              this.isstop=true
            }
            if(data.status==99){
              this.isstart=true
              this.isstop=false

            }
            //修改附件的链接
            let strvalue=[]//id链接
            if(this.upData==null){//判断是否有附件
              this.upData=[]
            }else{
              for(let i =0;i<this.upData.length;i++){
                if(this.upData[i].key==''){
                  this.upData.splice(i,1)
                }else{
                  strvalue.push(this.upData[i].key.key)
                }
              }
              let s1 = strvalue.join(',')
              this.attrid = s1//id链接后字符串

            }
            
          }
        })
			},
			//点击保存新建基本信息
			saveBaseInfo(name){
        
				this.$refs[name].validate((valid) => {
             if(valid) {
              this.axios.post('/client/add?uid=' + this.uid,{
				  		code:this.formValidate.code,//客户编码
              name:this.formValidate.name,//客户名称
              contractPhone:this.formValidate.contractPhone,//手机
              contractTel:this.formValidate.contractTel,//电话
              contract:this.formValidate.contract,//联系人

              contractFax:this.formValidate.contractFax,//联系人传真
              contractEmail:this.formValidate.contractEmail,//联系人邮箱
              contractPosition:this.formValidate.contractPosition,//联系人职位
              contractAddress:this.formValidate.contractAddress,//联系人地址
              level:this.level,//等级
              classify:this.classify,//类型
              city:this.city,
              province:this.province,
              district:this.district,
              address:this.address,//地址
              remark:this.remark,//备注
              attachs:this.attrid,//多附件地址
							taxNo:this.formValidate.swdjh,//税务登记号
							credits:this.formValidate.credits,//信用额度
							invoiceTitle:this.formValidate.invoiceTitle,//发票抬头
							bank:this.formValidate.khh,//开户行
							regAddress:this.formValidate.regAddress,//注册场所地址
							regTel:this.formValidate.regTel,//注册固定电话
              // accountName:this.formValidate.loginName,//账号
              // loginPs:this.formValidate.pass//密码
				  		}).then(res=>{
    				  			if(res.data.status==200){
                      this.$notify({
                          title: '',
                          message:this.$t('public.SaveSuccess'),//
                          type: 'success',
                          position: 'bottom-right'
                      });
    								this.formValidate.name=''//客户名称
    								this.formValidate.contractPhone=''//手机
    								this.formValidate.contractTel=''//电话
    								this.formValidate.swdjh=''//税务登记号
                    this.level=this.khlevel[0].value
                    this.classify=this.khclassify[0].value
    								// this.getkhlevel()//客户等级
            //         this.getkhclassify()//客户类型
    								// email:this.formValidate.email,//邮箱
    								// youbian:this.formValidate.youbian,//邮编
    								this.formValidate.credits=0//信用额度
    								this.formValidate.invoiceTitle=''//发票抬头
    								this.formValidate.khh=''//开户行
    								this.formValidate.regAddress=''//注册场所地址
    								this.formValidate.regTel=''//注册固定电话
                    this.formValidate.contract=''//联系人
                    this.formValidate.payment=''//应付金额
                    this.formValidate.receivable=''//应收金额
                    this.formValidate.contractFax=''//联系人传真
                    this.formValidate.contractEmail=''//联系人邮箱
                    this.formValidate.contractPosition=''//联系人职位
                    this.formValidate.contractAddress=''//联系人地址
                    this.formValidate.code='',
                    this.selectedOptions2=[]
                    this.formValidate.loginName=''//账号
                    this.formValidate.pass=''//密码
                    this.upData=[]
                    this.attrid=''
    								this.getUnitsListS();

    				  			}else{
                      this.$notify({
                          title:"",//
                          message:res.data.errorMessage,
                          type: 'error',
                          position: 'bottom-right'
                      });

    				  			}

    				  		})

                    }
                })
			},
			addborder5(index){
				this.num5=index

			},
			addborder(index){
				this.num2=index
				if(num2==1){

				}
			},
      //tab切换
			addborder1(index){
        
        
        
 
				this.num4=index
			
        switch(index){
          // case 0:
            //this.getglsku(id) //关联商品
          // break;
          case 1:
            this.getDetail(this.id)  //客户管理商品历史
            
          break;
          case 2:
          this.getAllAddress(this.id)//客户地址
          break;
          
          case 4:
              this.getglsku3(this.id)//报价商品
          break;
          
        }
			},
			//点击修改
			changeUnitInfo1(){
				this.detailsInfo=false
				// this.$refs.details.style.display='none'
				this.upBtn=true
				this.xiugai=true
				this.addText=false
				this.xiugaibtn1=false
				this.xiugaibtn2=true
        this.dis=true
        this.cancelxiu=true
        // this.$refs.disf.disabled=true
			},
			//修改客户信息
			changeUnitInfo2(name){
				this.$refs[name].validate((valid) => {
  					if(valid){
  						this.axios.put('/client/update?uid='+this.uid,{
  						  id:this.id,
  						  code:this.formValidate.code,//客户编码
                name:this.formValidate.name,//客户名称
                contractPhone:this.formValidate.contractPhone,//手机
                contractTel:this.formValidate.contractTel,//电话
                contract:this.formValidate.contract,//联系人

                contractFax:this.formValidate.contractFax,//联系人传真
                contractEmail:this.formValidate.contractEmail,//联系人邮箱
                contractPosition:this.formValidate.contractPosition,//联系人职位
                contractAddress:this.formValidate.contractAddress,//联系人地址
                level:this.level,//等级
                classify:this.classify,//类型
                city:this.city,
                province:this.province,
                district:this.district,
                address:this.address,//地址
                remark:this.remark,//备注
                attachs:this.attrid,//多附件地址
                taxNo:this.formValidate.swdjh,//税务登记号
                credits:this.formValidate.credits,//信用额度
                invoiceTitle:this.formValidate.invoiceTitle,//发票抬头
                bank:this.formValidate.khh,//开户行
                regAddress:this.formValidate.regAddress,//注册场所地址
                regTel:this.formValidate.regTel,//注册固定电话
                // accountName:this.formValidate.loginName,//账号
                // loginPs:this.formValidate.pass//密码
  					}).then((res)=>{

  						if(res.data.status=200){
                //console.log(res)

                 this.$notify({
                        title:"",//
                        message:this.$t('public.editSuccess'),//
                        type: 'success',
                        position: 'bottom-right'
                    });


  							this.addUnit()
                this.getUnitsList();
                this.updataUnit(this.id,this.numLeftList)
                this.getUnitDefault(this.id)

  						}else{
                 this.$notify({
                        title:"",//
                        message:res.data.errorMessage,
                        type: 'error',
                        position: 'bottom-right'
                    });

  						}
  					})
  				}
				})

			},
			//取消
			cancel(){
				this.addUnit()
        this.updataUnit(this.id,this.numLeftList)
			},
			//获取联系人列表
			getUserList:function(){
				// if(this.id){
				// 	this.axios.get('/pcontract/query?uid='+this.uid).then((res)=>{
				// 		let data=res.data.rows;
				// 		if(res.data.status=='200'){
				// 			this.userList=data;

				// 		}else{
				// 			////this.$Message.error(res.data.errorMessage);
				// 		}
				// 	})
				// }
			},
			 //删除供应商信息
            delunit: function() {
               //修改的时候 删除  删除供应商
              //////console.log(this.id)
               this.axios.delete('/client/delete/' + this.id + '?uid=' + this.uid).then(res=>{
               	if(res.data.status==200){

                  this.$notify({
                     title:"",//
                      message:this.$t('public.deleteSuccess'),//
                      type: 'success',
                      position: 'bottom-right'
                  });
                    this.addUnit()
                      this.getUnitsList()
                       this.id=''
               		}else{

                    this.$notify({
                     title:"",//
                      message:'删除失败',
                      type: 'error',
                      position: 'bottom-right'
                  });
               		}

               })

            },

           //点击停用
			stopUnits:function(){
				this.axios.post('/client/disabled/'+this.id+'?uid='+this.uid).then((res)=>{
					 if(res.data.status=='200'){
             this.$notify({
                title:"",//
                message:this.$t('public.normalT'),
                type: 'success',
                position: 'bottom-right'
            });
						this.getUnitsList()
            this.id=''
					 }else{
            this.$notify({
                title:"",//
                message: res.data.errorMessage,
                type: 'error',
                position: 'bottom-right'
            });
           }
				})
			},
			//启用
			start(){
				this.axios.post('/client/enabled/'+this.id+'?uid='+this.uid).then((res)=>{
					 if(res.data.status=='200'){

            this.$notify({
                title:"",//
                message:this.$t('public.normalS'),
                type: 'success',
                position: 'bottom-right'
            });
						this.getUnitsList()
            this.id=''
					 }else{
            this.$notify({
                title:"",//
                message: res.data.errorMessage,
                type: 'error',
                position: 'bottom-right'
            });
           }
				})
			},
       //账号管理
        loginSetting(){
          this.loginModel=true
        },
        //发送验证码
        sendYzm(){
        //调接口获得验证码PUT /client/sendCode/{mobile} 身份验证发短信
          this.axios.put('/client/sendCode/'+this.user.mobile+'?uid='+this.uid).then((res) => {
              if(res.data.status == 200) {
                this.yzm=false
                this.yzm1=true
                var _this=this;
                this.$Message.success('正在发送验证码,请稍等...');
                var timer=setInterval(function(){
                  _this.yzmnumber--;
                  if(_this.yzmnumber==0){
                    _this.yzm1=false;
                    _this.yzmnumber=60
                    _this.yzm=true;
                    clearInterval(timer);
                  }
                },1000)
              }else{
                this.$notify({
                        title:"",//
                        message:res.data.errorMessage,
                        type: 'error',
                        position: 'bottom-right'
                    });
              }
          })
        },
        //保存密码修改
        savePs(name){
          this.$refs[name].validate((valid) => {
            if(valid){
              this.axios.put('/client/updatePs/'+this.id+'?mobile='+this.user.mobile+'&code='+this.formValidatelogin.loginphone+'&newPs='+this.formValidatelogin.loginNewPass+'&uid='+this.uid).then((res) => {
                  if(res.data.status==200){
                    this.$notify({
                        title:"",//
                        message: this.$t('public.editSuccess'),//
                        type: 'success',
                        position: 'bottom-right'
                    });
                    this.yzm=true
                  this.yzm1=false
                  this.yzmnumber=60
                  this.loginModel=false
                  }else{
                    this.$notify({
                        title:"",//
                        message: res.data.errorMessage,
                        type: 'error',
                        position: 'bottom-right'
                    });
                  }
              })
            }
          })
        },
        //取消
        cancelPs(){
          this.loginModel=false
          this.formValidatelogin.loginphone=""
          this.formValidatelogin.loginNewPass=""
        },
       //关联商品
			getglsku(){
				this.axios.get('client/sku/'+this.id+'?uid='+this.uid).then(res=>{
						if(res.data.status==200){
							this.selectedgoodsrow1=res.data.rows
							this.yxskudata=res.data.rows
              console.log(this.selectedgoodsrow1)
							this.goodskey1pageSize=res.data.pageSize
							this.goodskey1total=res.data.total
              
							this.yxskudata.forEach((x,index)=>{
                  x.skuCode=this.yxskudata[index].skuVo.skuCode
                  x.skuId=this.yxskudata[index].skuVo.id
                  x.price=this.yxskudata[index].skuVo.price
                  x.costPrice=this.yxskudata[index].skuVo.costPrice
                  x.wholePrice=this.yxskudata[index].skuVo.wholePrice
                  x.unit=this.yxskudata[index].skuVo.unit
                  x.unitId=this.yxskudata[index].skuVo.unitId
                  x.className=this.yxskudata[index].skuVo.className
                  x.classId=this.yxskudata[index].skuVo.classId
                  x.inventoryUp=this.yxskudata[index].skuVo.inventoryUp
                  x.inventory=this.yxskudata[index].skuVo.inventory
                  x.barcode=this.yxskudata[index].skuVo.barcode
                  x.barnd=this.yxskudata[index].skuVo.barnd
                  x.mainPhoto=this.yxskudata[index].skuVo.mainPhoto
                  x.photos=this.yxskudata[index].skuVo.photos
                  x.unitList=this.yxskudata[index].skuVo.unitList
                  x.unitDesc=this.yxskudata[index].skuVo.unitDesc
                  x.attrDetailList=this.yxskudata[index].skuVo.attrDetailList
                  x.partnerId=this.id
                  x.specs=this.yxskudata[index].skuVo.specs
                })
              
						}else{
							this.selectedgoodsrow1=[]
						}
					})
			},
       //关联商品切换一条页
      goodskey1getData(current){
          this.axios.get('client/sku/'+this.id+'?offset='+current+'&uid='+this.uid).then((res)=>{
              ////////console.log(res)
              this.selectedgoodsrow1 = res.data.rows
              this.goodskey1pageSize=res.data.pageSize
              this.goodskey1total=res.data.total
          })
      },
      //翻页
      goodskey1changePageSize(size){
          this.goodskey1pageSize = size
      },
      //报价商品
      getglsku3(id){
        this.axios.get('quotation/sku/'+id+'?uid='+this.uid).then(res=>{
            if(res.data.status==200){
              this.selectedgoodsrow3=res.data.rows
              this.goodskey3pageSize=res.data.pageSize
              this.goodskey3total=res.data.total
              // //console.log(res.data.rows)

            }else{
              this.$notify({
                    title:"",//
                    message: res.data.errorMessage,
                    type: 'error',
                    position: 'bottom-right'
                });
            }
          })
      },
       //报价商品切换一条页
      goodskey3getData(current){
          this.axios.get('quotation/sku/'+this.id+'?offset='+current+'&uid='+this.uid).then((res)=>{
           
              this.selectedgoodsrow3 = res.data.rows
              this.goodskey3pageSize=res.data.pageSize
              this.goodskey3total=res.data.total
          })
      },
      //翻页
      goodskey3changePageSize(size){
          this.goodskey3pageSize = size
      },
			//客户管理报价单历史
			getDetail(id){
				this.axios.get('client/quotation/'+id+'?uid='+this.uid).then(res=>{
					if(res.data.status==200){
						this.selectedgoodsrow2=res.data.rows
						this.goodskey2total=res.data.total
						this.goodskey2pageSize=res.data.pageSize
						this.selectedgoodsrow2.forEach((x)=>{
              x.mobile=x.customer.contractPhone
              x.name1=x.customer.name
							x.startTime=this.getLocalTime(x.startTime)
              x.endTime=this.getLocalTime(x.endTime)							
              x.recordDate=this.getLocalTime(x.recordDate)
						})

					}
				})
			},
			     //报价单历史切换一条页
            goodskey2getData(current){
                this.axios.get('client/quotation/'+this.id+'?offset='+current+'&uid='+this.uid).then((res)=>{
                   if(res.data.status==200){
                      this.selectedgoodsrow2=res.data.rows
                      this.goodskey2total=res.data.total
                      this.goodskey2pageSize=res.data.pageSize
                      this.selectedgoodsrow2.forEach((x)=>{
                        x.mobile=x.customer.contractPhone
                        x.name1=x.customer.name
                        x.startTime=this.getLocalTime(x.startTime)
                        x.endTime=this.getLocalTime(x.endTime)              
                        x.recordDate=this.getLocalTime(x.recordDate)
                      })

                    }

                })
            },
            //报价单历史翻页
            goodskey2changePageSize(size){
                this.goodskey2pageSize = size
            },
            //点击差号
            cancelHome(){
                this.$router.push('/customer')
            },
            //下拉加载更多
            handleReachEdge(){
    				   this.current++//默认10条
        	 		this.axios.get('/client/query?cl='+this.valueT+'&offset='+this.current+'&uid='+this.uid).then((res)=>{

      	 				if(res.data.status==200){
                  if(this.current>Math.ceil(this.total/this.pageSize)){
                        this.current=Math.ceil(this.total/this.pageSize)
                    }
                  let data= res.data.rows
                    data.forEach((item)=>{
                  item.createTime=new Date(item.createTime).toLocaleDateString().replace(/\//g,'-')
                    this.Allunits.push(item)
                    this.Allunits.forEach((x,index)=>{
                      x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
                    })
                  })
                }
      			 	})

            },

            //下拉关联商品按钮
            glsku(){
            	this.axios.get('sku/list?uid='+this.uid).then(res=>{
            		if(res.data.status==200){

            			this.kxskudata=res.data.rows
            			this.gyspageSize=res.data.pageSize
                   		this.gystotal=res.data.total
            		}
            	})
            	this.glskuisshow=true
            },
             //切换一条页
            getgysData(current){
                this.axios.get('sku/list?offset='+current+'&uid='+this.uid).then((res)=>{
                    ////////console.log(res)
                   	this.kxskudata=res.data.rows

                   })
            },
            //翻页
            changegysPageSize(size){
                this.gyspageSize = size
            },
            //商品模糊搜索
            searchSku(){
            	// alert()
            	this.axios.get('sku/list?keyword='+this.skuKeyword+'&uid='+this.uid).then((res)=>{

      					if(res.data.status==200){
      						this.kxskudata = res.data.rows
      						this.gyspageSize=res.data.pageSize
                  this.gystotal=res.data.total
      					}
      				})
            },
            //回车搜索
            serarsku(){
            	this.searchSku()
            },
            //添加关联商品
            addglsku(){
            	this.skuaddisshow=true
            },
            //关联商品确认
            sureglsku(){
              this.glskuisshow=false
                this.skuaddisshow=false
                this.getglsku()//刷新关联商品
                this.yxskudata=[]
            },
            //关联商品取消
            glskucancel(){
            	this.glskuisshow=false
            	this.skuaddisshow=false
            	this.getglsku()//刷新关联商品
            	this.yxskudata=[]
            },
            //新建商品
            sureglsku1(name){
            	this.$refs[name].validate((valid) => {
            		if(valid){
            			this.axios.post('sku/add?uid='+this.uid,{
	            		barcode:this.skuskuruleValidate.barcode,
	            		barnd:this.skuskuruleValidate.barnd,
	            		mainPhoto:this.mainPhoto,
	            		skuName:this.skuskuruleValidate.name,
	            		inventoryUp :this.skuskuruleValidate.inventoryUp,

	            		unit:this.skuskuruleValidate.unit,
	            		price:this.skuskuruleValidate.price,
	            	}).then(res=>{
	            		if(res.data.status==200){

                    this.$notify({
                        title:"",//
                        message:  '商品新建成功',
                        type: 'success',
                        position: 'bottom-right'
                    });
							       this.glsku()

		            		this.skuskuruleValidate.barcode=''
		            		this.skuskuruleValidate.barnd=''
		            		this.mainPhoto=''
		            		this.skuskuruleValidate.name=''
		            		this.skuskuruleValidate.inventoryUp=0

		            		this.skuskuruleValidate.unit=''
		            		this.skuskuruleValidate.price=0
	            		}else{
	            			this.$notify({
                        title: '提示',
                        message:  res.data.errorMessage,
                        type: 'error',
                        position: 'bottom-right'
                    });

	            		}

	            	})
            		}
            	})
            },
            //关联商品取消
            glskucancel1(){

            	this.skuaddisshow=false

            },
            //上传图片成功
			addsucess(res,file){

				this.mainPhoto=res.rows.url
			},
			//选择客户
			selekh(){
				this.khisshow=true
				this.axios.get('/client/query?uid=' + this.uid).then((res) => {

					let data = res.data;

					if(res.data.status == '200') {

						this.gysdata = data.rows;

					} else {
						// this.$Message.error(res.data.errorMessage);
					}
				})
			},

			//客户模糊搜索
			getgysKeyword(){

				this.axios.get('client/list?keyword='+this.gyskeyword+'&uid='+this.uid).then((res)=>{

					if(res.data.status==200){

						this.gysdata = res.data.rows
					}
				})

			},
			//客户弹框出现后点击表格行数据
			gysrow(data,index){

				this.partnerId=data.id
				this.khName=data.name

  			},
  			//客户取消
  			modelCancel(){
  				this.khisshow=false
  			},
  			makegys(){
  				this.khisshow=false
  			},
            //制作报价单
            bjd(){
            	this.$router.push('quotationadd')
            },
            //选中客户等级
            changekhlevel(v){
         
            	this.level=v
            },
            //客户等级
            getkhlevel(){
              this.axios.get('clientl/query?length=99&uid='+this.uid).then(res=>{
                if(res.data.status==200){
                 let data=res.data.rows
                  data.forEach((x,index)=>{
                    let arr={
                      label:data[index].title,
                      value:data[index].key,
                    }
                    this.khlevel.push(arr)
                    this.level=this.khlevel[0].value
                  })
                  
                  console.log(this.level)
                }
              })
            },
            //选中客户类型
            changekhclassify(v){

              this.classify=v
            },
            //客户类型
            getkhclassify(){
              this.axios.get('clientt/query?length=99&uid='+this.uid).then(res=>{
                if(res.data.status==200){
                 //console.log(res.data.rows)
                  res.data.rows.forEach((x,index)=>{
                    let arr={
                      label:res.data.rows[index].title,
                      value:res.data.rows[index].key,
                    }
                    this.khclassify.push(arr)
                    this.classify=this.khclassify[0].value
                  })
                }
              })
            },
             //上传之前类型之前

            beforeAvatarUpload(file){

               var fileName=new Array()
                fileName =file.name.split('.');
                // const extension = fileName[fileName.length-1] === 'xls'
                // const extension2 =  fileName[fileName.length-1]=== 'xlsx'
                const isLt2M = file.size / 1024 / 1024 < 20
     //            if (!extension && !extension2) {
     //                // this.$message({
     //                //     message: '',
     //                //     type: 'warning'
     //                // });
     //                this.$Notice.error({
          //  title: '提示',
          //  desc: '上传文件只能是xls、xlsx格式!'
          // });
     //            }
                if (!isLt2M) {

                    this.$notify({
                        title: '提示',
                        message:  '上传文件大小不能超过 20MB!',
                        type: 'error',
                        position: 'bottom-right'
                    });
                }
               //  if (extension || extension2 && isLt2M == true) {

               //      // let fd = new FormData()

               //      // fd.append('file', file)
               //      // //console.log(fd)
               //      // this.newImport(file)
               //      return true
               //  }
              return isLt2M

            },
            //文件上传时
            upProgress(event, file, fileList){
              if(file.status=='uploading'){
                this.soe=true
              }

            },
               //成功后的会掉
            success(response, file, fileList){
                if(response.status==200){

                   //判断后缀名
                   this.soe=false
                    var index1=file.name.lastIndexOf(".");
                    var index2=file.name.length;
                    var postf=file.name.substring(index1,index2)
                    // //console.log(postf)
                   let arr={
                      name:file.name,
                      type:file.raw.type,
                      url:file.url,
                      t:postf,
                      key:response.rows
                   }
                   this.upData.push(arr)
                   //console.log(this.upData)
                    this.upData.forEach((x,index)=>{
                      if(this.upData[index].t=='.txt'){
                        this.upData[index].url="../../../static/img/cg_bg1.png"
                      }
                      if(this.upData[index].t=='.xls' || this.upData[index].t=='.xlsx'){
                        this.upData[index].url="../../../static/img/cg_bg2.png"
                      }
                      if(this.upData[index].t=='.docx'){
                        this.upData[index].url="../../../static/img/cg_bg_docx.png"
                      }

                      if(this.upData[index].t=='.png' || this.upData[index].t=='.jpg' || this.upData[index].t=='.jpeg'){
                        this.upData[index].url=this.upData[index].url
                      }
                      if(this.upData[index].t!='.jpeg' && this.upData[index].t!='.png'  && this.upData[index].t!='.jpg'  && this.upData[index].t!='.txt'  && this.upData[index].t!='.xls'  && this.upData[index].t!='.docx'  && this.upData[index].t!='.xlsx'){
                        this.upData[index].url='../../../static/img/bg_sku_img.png'
                      }
                    })
                    let strvalue=[]//id链接

          for(let i =0;i<this.upData.length;i++){
            if(this.upData[i].key==''){
              this.upData.splice(i,1)
            }else{
              strvalue.push(this.upData[i].key)

            }

          }
          let s1 = strvalue.join(',')
          this.attrid = s1//id链接后字符串
          //console.log(this.attrid)

                }else{

                this.$notify({
                title:"",//
                message: response.errorMessage,
                type: 'error',
                position: 'bottom-right'
              });
                }
            },
             //移动到差号
            chaOver(item,index){

              this.chaIndex=index
            },
             //离开差号
            chleave(){
              this.chaIndex=-1
            },
            //点击差号删除POST /file/action/delete
            delUp(item,index){
              this.upData.splice(index,1)
              let strvalue=[]//id链接

              for(let i =0;i<this.upData.length;i++){
                if(this.upData[i].key==''){
                  this.upData.splice(i,1)
                }else{
                  strvalue.push(this.upData[i].key)

                }

              }
              let s1 = strvalue.join(',')
            this.attrid = s1//id链接后字符串
              this.axios.post('/file/action/delete?key='+item.rows+'&uid='+this.uid).then(res=>{
                if(res.data.status==200){

                }
              })
            },
            //精准搜索
            searchLocation(){
              this.psisshow=true
            },
            //精准搜索确认
            sureSearchLocation(){
               this.axios.get('/client/query?uid=' + this.uid,{
                contractPhone:this.supplierContractPhone,
                name:this.supplierName
               }).then((res) => {
                if(res.data.status==200){
                  let data = res.data
                      this.Allunits = data.rows;
                      this.pageSize = data.pageSize;
                      this.total = data.total;
                      this.supplierContractPhone=''
                      this.supplierName=''
                      this.psisshow=false
                  }
               })
            },
             //精准搜索取消
            cancelSearchLocation(){
              this.supplierContractPhone=''
              this.supplierName=''
              this.psisshow=false
            },
            //点击搜索
            search(){
                this.axios.get('/client/query?keyword='+this.searchKeyword+'&uid=' + this.uid).then((res) => {
                   let data = res.data;
                  //console.log(data)
                  if(res.data.status == '200') {
                    this.Allunits = data.rows;
                    this.pageSize = data.pageSize;
                    this.total = data.total;
                    this.Allunits.forEach(x=>{
                      x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
                    })
                  }
                })
           },
            //回车搜索
            enterSearch(){
                this.search()
            },

            //下拉框选择
            orderselected(value){
              this.value=value
              this.valueT=value
              this.current=1
                this.axios.get('/client/query/?cl='+value+'&uid=' + this.uid).then((res) => {
                    if(res.data.status == '200') {
                        let data = res.data
                        this.Allunits = data.rows;
                        this.pageSize = data.pageSize;
                        this.total = data.total;
                        this.Allunits.forEach(x=>{
                          x.createTime=new Date(x.createTime).toLocaleDateString().replace(/\//g,'-')
                        })
                    }
                })
            },
            //邀请GET /client/invite 邀请客户
              Invitation(){
                if(this.id==''){
                  this.$notify({
                        title:"",//
                        message: '请选择一条客戶',
                        type: 'error',
                        position: 'bottom-right'
                      });
                }else{
                  this.axios.get('client/invite/?mobile='+this.formValidate.contractPhone+'&uid='+this.uid).then(res=>{
                    if(res.data.status==200){
                      this.$notify({
                            title: '',
                            message: '邀请成功',
                            type: 'success',
                            position: 'bottom-right'
                          });
                    }else{
                      this.$notify({
                        title: '',
                        message:res.data.errorMessage,//
                        type: 'error',
                        position: 'bottom-right'
                      });
                    }
                  })
                }

              },
		},
		mounted() {
      this.upBtn = true
      this.getkhlevel()//客户等级
      this.getkhclassify()//客户类型
			this.$nextTick(()=>{
				this.getUnitsList()
        this.detailsInfo=false
        // this.$refs.details.style.display='none'
				if(this.$route.query.id){

					this.id = this.$route.query.id;
					this.numLeftList = this.$route.query.index
					this.updataUnit(this.id,this.numLeftList)
					this.getUnitDefault(this.id)
					// this.$refs.details.style.display='block'
          this.detailsInfo=true
				}
				if(this.$route.query.id==''){
					// this.$refs.details.style.display='none'
          this.detailsInfo=false
				}
				this.height = document.documentElement.clientHeight
				// this.handleReachEdge()//滚动加载
				window.onresize=function(){
					this.height = document.documentElement.clientHeight
				}

			})

		}
	}
</script>

<style lang="css" scoped>

.footer-mark{
  width:100%;
  height:40px;
  border-top:1px solid #E4E4E4;
  display: flex;
  justify-content: space-around;
  margin-bottom:-10px;
}
.footer-mark span{
  height:40px;
  line-height: 40px
}
.upcha{
    cursor:pointer;
    /*border:1px solid red;*/
    position: absolute;
      top: 5px;
      left: 115px;
  }
.upDataList{
  width:100%;
  display: flex;
  flex-wrap: wrap;
}
.upDataList li{
  position:relative;
  margin:10px;
  width:132px;
  /*height:100px;*/
  border:1px solid #e4e4e4;
  padding:5px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
.upDataList li span{
  text-align: center;
}
.addInfo{
    /*margin-left: 50px;*/
    display: block;
    width:60px;
    text-align: center;
    margin-bottom: 20px;
    margin-left: 20px;
    color: #2B8F8F;
    font-weight:600;
    border-bottom:2px solid #2B8F8F;
}
.upDataList{
  width:100%;
  display: flex;
  flex-wrap: wrap;
}
.upDataList li{
  margin:10px;
  width:132px;
  /*height:100px;*/
  border:1px solid #e4e4e4;
  padding:5px;
  display: flex;
  justify-content: center;
  align-items: center;
  flex-direction: column;
}
.upDataList li span{
  text-align: center;
}
.top-left-btn{
		background: #3B77E3;
	    margin-right: 10px;
	    color: #fff;
	    border: none;
	    width: 26px;
	    height: 26px;
	    border-radius: 26px;
	    display: inline-block;
	    position: relative;
	    top: 12px;
	}
  .tot{
    position:fixed;
    bottom:10px;
    left:15%;
    z-index:12;
}
	.top-left-btn1{
		background: #FF7D16;
	}
	.top-left-btn:hover{
		cursor:pointer;
	}
.bg{
	background: #dbe5f1
}

.checkbox{
	margin-right:10px;
	border-color:#000;
}
	.add-box {
		width: 100%;

	}
.heade{
  width:100%;
  height:60px;
  display: flex;
  position: fixed;
  z-index:10;
  background: #fff;
  border-bottom:1px solid #e4e4e4;
}

    .addRess{
      width:100%;
      height:100%;
     height:300px;

      border:1px solid #f5f5f5;
    }
    .addRess-top{
      width:100%;
      height:50px;
      line-height: 50px;
      display: flex;
      justify-content: space-between;
      background: #F1F1F1
    }
     .addRess-top .addressTitle{
      font-weight:600;
      font-size:14px;
     }
     .addRess-top1{
      width:100%;
      height:40px;

      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom:1px solid #f1f1f1;
    }
     .addRess-top1:last-child{
        margin-bottom:400px;

     }
     .addressbtn0{
      width:10%;
      text-align: center;
     border-left:1px solid #f1f1f1;
     }
    .addressbtn{
      width:10%;
      text-align: center;


     border-left:1px solid #f1f1f1;
    }
    .address-left{
      padding:0 10px;
      width:10%;
      text-align: center;
      border-right:1px solid #f1f1f1;

    }
    .left-top{
  		height: 60px;
  		width:360px;
      flex:0 0 360px;
  		line-height: 60px;

  		display:flex;
  		background: #fff;
  		border-right:1px solid #eee;
  		border-bottom:1px solid #eee;
  		justify-content: space-between;
	}
	.right-top{
		height: 60px;
		line-height: 60px;
		display:flex;
		margin-left:360px;
		justify-content: space-between;

	}
    .right-top button:hover{
        color:#478FCA;
    }
    .right-top button img{
        position:relative;
        left:0px;
        top:-2px;
        vertical-align: middle;

    }
     .right-left{
	width: 192px;

	border:1px dashed #e1e1e1;
}
	.left-content {
		height:100%;
		width:360px;
    flex: 0 0 360px;
		margin-bottom:300px;
		z-index:9;
		border-right:1px solid #E6E6E6;
		position:fixed;
		background:#F9F9F9;
	}
	.add-right {
		background: #fff;
		height:100%;
		margin-left:360px;
		padding-top:10px;
	}

	.add-box:after {
		content: '';
		display: block;
		clear: both;
	}
	.textbg1{
    color:#40ca98
  }
  .textbg2{
    color:#d53c39
  }
	.add-left {
		min-height: 600px;
		background: #fff;
		border-radius: 6px;
		padding-top: 15px;
		margin-right: 20px;
		float: left;
		padding-bottom: 20px;
	}

	.add-left .left-title {
		width: 100%;
		height: 40px;
		line-height: 40px;
		padding-left: 20px;
		border-left: 3px solid #00a8ff;
	}

	.add-left .left-title .title-txt {
		font-size: 14px;
		color: #585858;
		width: 120px;
	}

	.left-btn {
		height: 40px;
		float: right;
		margin-top: -40px;
	}
	.title{
    	display:flex;justify-content: space-between;margin-top:20px
    }
    .title:hover{
    	cursor:pointer;
    }
	.left-btn button {
		width: 70px;
		height: 40px;
		color: #fff;
		font-size: 14px;
		color: #ececec;
		border: 0;
		border-radius: 6px;
	}
	.quotationaddLength{
    position: relative;
    left: -505px;
    top:-45px;
    height: 15px;
    border-radius: 10px;
    min-width:15px;
    background: #ed3f14;
    border: 1px solid transparent;
    color: #fff;
    line-height: 15px;
    text-align: center;
    padding: 0 10px;
    font-size: 12px;
    white-space: nowrap;
    -ms-transform-origin: -10% center;
    transform-origin: -10% center;
    z-index: 10;
    box-shadow: 0 0 0 1px #fff;
  }
	.ivu-icon-navicon {
		font-size: 20px;
	}
	.con-list {
		display:flex;
		align-items: center;
		width: 100%;
		word-wrap:break-word;

		border-bottom: solid 1px #E6E6E6;
		padding: 15px 25px;

		cursor: pointer;
		position:relative;
	}
  .detail-top{
    margin-left:20px;
  }
.detail-top ul.cgtable1{
    	margin-bottom: 20px
    }
    .detail-top li{
      list-style: none
    }
    .blackinfo li{
      list-style: none;
      margin:15px 0;
      display: flex;

    }
    .blackinfo{
      margin-right:30px;
      width:33%;
    }
    .detail-top h4{
      color:#2B8F8F;
      width:60px;
      text-align: center;
      border-bottom:2px solid #2B8F8F;
    }
    .detail-top li {
      margin:0 10px 0 0;
    }
   .detail-top li span.blackinfo-left{

    color: #2B8F8F;
    /* margin: 0px 10px; */
    font-weight: 600;
    
    }
    .detail-bottom{
        margin-top:20px;
    }
	.con-list:hover{
		cursor:pointer;
	}
	.con-list .date{
		position:absolute;
		right:30px;
		top:20px;
	}
  .title-ht span{
    width:20%;
    text-align: center
  }
	.con-list .status{


		text-align: center;
		position: absolute;
	    right: 10px;
	    top: 47px;
	}
	.con-list .list-title {
		color: #0d0d0d;
		font-size: 14px;
		margin-bottom: 10px;
	}
	.avatar-uploader .el-upload {
    border: 1px dashed #d9d9d9;
    border-radius: 6px;
    cursor: pointer;
    position: relative;
    overflow: hidden;
  }
  .avatar-uploader .el-upload:hover {
    border-color: #409EFF;
  }
  .avatar-uploader-icon {
    font-size: 28px;
    color: #8c939d;
    width: 178px;
    height: 178px;
    line-height: 178px;
    text-align: center;
  }
  .avatar {
    width: 178px;
    height: 178px;
    display: block;
  }


	.con-list .txt {
		color: #585858;
		font-size: 12px;
	}

	.page-box {
    text-align: left;
		margin-top:10px;
	}

	.cursor div,.cursor div p{
		cursor:default;
	}
.right-content{
    width: 100%;

  }
	.bor{
		border-bottom:2px solid #086CA2;
	}
	.detail-title-mark{
		display:flex;
		justify-content: flex-start;
		border-bottom:1px solid #eee;
		margin-bottom:10px;
		margin-top:-10px;
		margin-left: 10px;
	}
	.detail-title{
		padding:10px 40px;

	}
	.detail-title:hover{
		cursor:pointer;
	}
	.con-title {
		width: 100%;
		border-bottom:2px solid #086CA2;
	}

	.con-title button {
		width: 80px;
		height: 30px;
		font-size: 12px;
		border: 0;
		border-radius: 5px 5px 0px 0px;
		outline: none;
	}
	.con-title button:hover{
		cursor:pointer;
	}
	.con-title button:first-child {
		margin-right: 10px;
	}
	/**激活的button样式**/

	.btnact {
		background: #086ca2 !important;
		color: #fff !important;
	}
	/***正常的样式***/
	.right-detail{
		margin-bottom:90px;
    position:relative;
    width:100%;
	}
	.normal {
		background: #d9dbdc !important;
		color: #585858 !important;
	}


	.input-box {
		display:flex;
		width:100%;
		height: 40px;
		color: #585858;
		height:35px;
		line-height: 35px;
		margin-bottom: 15px;

	}

	.input-box p{
		width:120px;
		height: 40px;
		text-align: center;
		line-height: 40px;
		color: #585858;
		font-size: 12px;

	}

	.input-box input {
		height: 40px;
		border: 1px solid #ececec;
		border-radius: 6px;
		padding: 0 10px;
	}

	.act-txt {
		width: 50%;
		margin-top: -45px;
	}

	.act-txt span {
		font-size: 12px;
		color: #f37b1d;
	}

	.act-txt span:first-child {
		font-weight: bold;
	}
	/****新增联系人信息****/

	.user-box {
		width: 100%;
		height: auto;
		padding: 15px 0;
	}

	.user-box:after {
		content: '';
		display: block;
		clear: both;
	}

	.user-box .add-user {
		width: 310px;
		height: 250px;
		background-color: #ffffff;
		box-shadow: -1px 0px 7px 0px rgba(0, 0, 0, 0.35);
		border-radius: 6px;
		border: dotted 1px #ececec;
		text-align: center;
		font-size: 80px;
		padding-top: 40px;
		color: #999999;
		margin-bottom: 15px;
		margin-right: 20px;
		float: left;
	}

	.user-box .add-user p {
		font-size: 18px;
		color: #acacac;
		margin-top: 10px;
	}
	button{
		border:none;
	}

	.wldw{
		margin-left:20px;
	}



	.po-btn {
		position: absolute;
		top: 15px;
		right: 20px;
	}

	.po-btn button {
		border: 0;
		background: none;
		outline: none;
		font-size: 14px;
	}

	.po-btn button:first-child {
		color: #00a8ff;
		margin-right: 10px;
	}

	.po-btn button:last-child {
		color: #dd5a43;
	}
	.check-box {
		width: 100%;
	}

	.data-box {
		margin-top: 10px;
	}

	.text-box textarea {
		width: 86%;
		height: 180px;
		padding: 10px;
		border: 0;
		border-radius: 6px;
	}
   .lanren {
       position: absolute;
    text-align: center;
    top: -8px;
    right: 3px;
    width: 0;
    height: 0;
    border-top: 80px solid #d53c39;
    border-left: 80px solid transparent;
}
.lanren span{
    width: 60px;
    height: 60px;
    color: #fff;
    display: block;
    position: relative;

    top: -70px;
    right: 70px;
    font-size: 16px;
    font-weight: 900;
    transform: rotate(46deg);
}
.lanrenLeft{
  position: absolute;
    text-align: center;
    top: 0px;
    right: 0px;
    width: 0;
    height: 0;
    border-top:40px solid #d53c39;
    border-left:40px solid transparent;
}
.lanrenLeft span{
width: 40px;
    height: 23px;
    color: #fff;
    display: block;
    position: relative;
    z-index: 9999999999999;
    top: -36px;
    right: 36px;
    font-size: 12px;
     font-weight: 100;
    transform: rotate(46deg);
}
.bgd4{
    border-top:40px solid #40ca98;
}
/*状态的颜色 新增*/
.bgd5{
    border-top:40px solid #3b77e3;
}
/*状态的颜色 已停用*/
.bgd6{
    border-top:40px solid #d53c39;
}
.bgd1{
   border-top: 80px solid #40ca98;
}
.con-list:last-child{
    margin-bottom:300px;
  }
</style>
<style>
	.ivu-checkbox-inner {
		border-radius: 50%;
	}

	.flclass:last-child{
		margin-bottom:150px;
	}

.ivu-modal-header{
  padding:10px!important;
}

.el-input__inner{
  border: 1px solid #e4e4e4!important;
  height: 32px!important;
}
.el-collapse-item .el-collapse-item__wrap{
  overflow: unset!important;
}
</style>
